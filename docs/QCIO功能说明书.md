QCIQ (Millennium Messenger) 功能模块说明书

1. 产品概述

QCIQ 是“千禧时光机”小程序内的核心虚拟社交模块，致敬 2005-2008 年代的经典即时通讯软件 UI 与交互。
它不是一个真实的社交软件，而是一个**“过家家”式的怀旧模拟器**。用户在这里扮演当年的自己，与 AI 好友互动，经营自己的虚拟形象与空间。

2. 核心功能模块详解

2.1 用户身份面板 (The Panel)

模拟经典的“瘦长条”主面板 UI。

头像系统 (Avatar)

默认头像：内置 10-20 款经典的“杀马特”、“非主流”、“卡通”风格低分辨率头像供选择。

自定义头像 (黄钻特权)：

仅限激活“黄钻”的用户上传。

安全合规：上传的图片必须经过微信云开发 security.mediaCheckAsync 接口审核。审核通过前显示“审核中”占位图，审核失败则恢复默认。

QCIQ 号码

用户首次进入时，随机生成一个 5-9 位的数字 ID（模拟靓号）。

生成逻辑：Math.random() 结合数据库查重，存入云数据库 users 集合。

个性签名

用户输入普通文本。

处理流程：

security.msgSecCheck (安全检测)。

火星文转换器 (自动转码)。

更新显示。

目的：确保签名既有“那味儿”又合规。

等级系统

图标：⭐ (星星) → 🌙 (月亮) → ☀ (太阳) → 👑 (皇冠)。

计算公式：1 皇冠 = 4 太阳，1 太阳 = 4 月亮，1 月亮 = 4 星星。

经验获取：

在线挂机：小程序保持前台运行每分钟 +1 经验。

踩一踩：被好友（或通过分享被真实微信好友）踩空间，每次 +5 经验。

2.2 虚拟增值服务 (VIP System)

模拟当年的“钻”文化，作为小程序的变现与留存机制。

💎 黄钻贵族

特权：自定义头像、空间自定义皮肤、空间背景音乐（BGM）。

获取方式：

观看激励视频广告：获得 24 小时体验卡。

私域 VIP：在“关于”页面输入特定激活码（由作者在私域/公众号分发）永久激活。

💎 红钻贵族

特权：QQ 秀（Avatar）专属服饰（如有）、聊天气泡变色、昵称变红。

获取方式：同黄钻。

2.3 好友列表与 AI 聊天 (Buddy List & AI Chat)

模拟好友列表分组（如“我的好友”、“陌生人”、“黑名单”）。

AI 机器人好友

列表预置 3-5 位不同人设的 AI 好友。

人设 A（轻舞飞扬）：文艺女青年，喜欢发伤感文字。

人设 B（龙傲天）：游戏大神，说话带“本尊”、“Gank”。

人设 C（网管小哥）：实用主义，回复简短，偶尔推销“网费充值”。

聊天交互

UI：复古蓝色/橙色聊天窗口，包含“震动窗口”功能（手机震动反馈）。

音效：经典的“咳咳”上线声、“滴滴滴”消息声。

技术实现：复用现有的 chat 云函数，在 history 中注入不同 System Prompt 实现差异化风格。

2.4 核心娱乐：Q 空间 (Q-Zone)

定位：裂变与活跃的核心场景。严格控制 UGC 风险。

日志系统 (Mood -> Log)

机制：用户不能直接撰写日志正文。

操作：用户选择“今日心情”（如：忧伤、热血、甜蜜、迷茫）+ 输入 10 字以内的关键词。

生成：AI 基于心情和关键词，生成一篇 200 字左右的火星文日志。

例子：选“忧伤” -> 生成：“妳 婼 囮 晟 風... (此处省略 200 字伤感文学)”。

合规性：因为内容是 AI 基于安全库生成的，规避了用户发布违规信息的风险。

互动机制：踩一踩

盖楼：显示“历史访问人数”和“今日访问人数”。

裂变：用户点击“邀请好友来踩”，生成微信分享卡片（复古风格）。

奖励：微信好友点击卡片进入小程序，即视为“踩了一脚”，QCIQ 主人获得大量经验值。

留言板

仅显示系统生成的“虚假”留言（如：“路过~”、“回踩哦~”），不支持真实用户自由留言（极大降低审核成本）。

2.5 游戏中心 (Game Center)

集成现有组件与新游戏。

开心农场 (Happy Farm)

复用 miniprogram/components/farm-game 组件。

玩法：简单的种菜、偷菜（偷 AI 好友的菜）。

产出：获得的金币可用于购买空间装饰。

扫雷 (Minesweeper)

入口跳转至现有的 pages/star-explorer 页面。

3. 合规与风险控制 (Compliance & Risk)

鉴于微信小程序对 UGC（用户生成内容）的严格管控，本项目采取**“半封闭模拟”**策略。

风险点

解决方案

技术实现

自定义头像

图片涉黄/暴恐

调用 security.mediaCheckAsync。上传后先显示“审核中”，回调成功后再公开显示。

个性签名

文字涉政/辱骂

输入时调用 security.msgSecCheck。包含敏感词直接拦截或替换为 *。

空间日志

用户发布违规言论

切断输入源。仅允许选择预设心情/标签，内容全由 AI 生成，从根源杜绝违规。

空间留言

垃圾广告/引流

关闭真实留言功能。仅展示模拟数据或 AI 互动，营造热闹氛围但无实际 UGC 风险。

4. 数据库设计简述 (NoSQL)

集合：qciq_users

{
  "_id": "openid",
  "qciq_id": 88888,          // 显示用的QQ号
  "nickname": "往事隨風",
  "avatar_url": "cloud://...", // 自定义或默认ID
  "signature": "莪們是糖，甜到憂傷",
  "level_info": {
    "exp": 1024,
    "online_minutes": 500
  },
  "vip_status": {
    "yellow_diamond": false,
    "expire_date": 1709888888888
  },
  "farm_data": { ... }
}


集合：qciq_guestbook_logs (仅存 AI 生成后的记录)

{
  "_id": "...",
  "owner_openid": "...",
  "mood_type": "sad",
  "content": "AI生成的火星文内容...",
  "create_time": "2005-12-22"
}


5. 开发优先级 (Roadmap)

P0: QCIQ 面板 UI 搭建、号码生成、默认头像、等级计算逻辑。

P0: 空间“心情日志生成器” (对接 Chat 云函数)。

P1: 踩一踩逻辑 (分享卡片参数传递)。

P1: 黄钻/红钻 广告解锁逻辑。

P2: 接入 farm-game 组件和 AI 聊天页面跳转。