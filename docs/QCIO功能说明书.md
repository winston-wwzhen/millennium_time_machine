# QCIO 功能说明书

## 1. 产品概述

QCIO 是"千禧时光机"小程序内的核心虚拟社交模块，致敬 2005-2008 年代的经典即时通讯软件 QQ 的 UI 与交互。

它不是一个真实的社交软件，而是一个**"怀旧模拟器"**。用户在这里扮演当年的自己，与 AI 好友互动，经营自己的虚拟形象与 QQ 空间。

---

## 2. 核心功能模块

### 2.1 用户身份面板

模拟经典的"瘦长条"主面板 UI，Win98 风格设计。

#### 头像系统
- 默认头像：👤 emoji
- 可点击编辑昵称和签名

#### QCIO 号码
- 用户首次进入时，随机生成一个 **5 位数字 ID** (10000-99999)
- 生成逻辑：`Math.random()` 结合数据库查重，确保唯一性
- 存储位置：云数据库 `qcio_users` 集合

#### 个性签名
- 用户点击签名可打开编辑对话框
- 默认签名：`"承諾、絠什嚒用？還bùsんì洅見。"`（火星文风格）

#### 等级系统
- 图标：⭐ (星星) → 🌙 (月亮) → ☀️ (太阳) → 👑 (皇冠)
- 计算公式：1 皇冠 = 4 太阳，1 太阳 = 4 月亮，1 月亮 = 4 星星
- 初始等级：1 级

---

### 2.2 好友列表

模拟经典 QQ 好友列表分组 UI，支持展开/收起。

#### 预设好友分组

**葬爱家族**
- 忧郁王子 - 在线 - `莪，呮想靜靜。`
- 轻舞飞扬 - 在线 - `網絡湜虛幻、但情湜真。`
- 往事随风 - 离线 - `儭，記得回踩哦！`

**陌生人**
- 水晶之恋 - 在线 - `遇見伱，湜莪這輩孒最渿、`

#### 交互功能
- 点击好友头像：打开单人聊天窗口
- 在线状态显示：绿色圆点（在线）/ 灰色（离线）

---

### 2.3 AI 聊天功能

#### 单人聊天 (`/pages/qcio-chat/index`)
- 点击好友列表中的联系人进入
- 复用 `chat` 云函数
- 支持不同的 AI 人设（文艺女青年、游戏大神等）
- Win98 风格聊天窗口

#### 群聊 (`/pages/group-chat/index`)
- 预设群组：葬爱家族 (128人)
- AI 随机发言模拟群聊氛围
- 显示发言者名字
- 简化 UI，去掉工具栏

---

### 2.4 QQ 空间 (Q-Zone)

空间模块分为三个子 Tab：

#### 主页
**每日签到**
- 显示连续签到天数
- 签到获得经验奖励

**开心农场**
- 显示农场等级和金币
- 点击进入农场页面 (`/pages/farm/index`)
- 农场成就分享功能

#### 日志
**心情日志发布**
- 选择心情类型：
  - 💔 伤感
  - 🔥 热情
  - 💕 甜蜜
  - 🌫️ 迷茫
- 输入关键词（可选）
- 输入日志内容
- AI 自动生成火星文风格日志

**日志列表**
- 按时间倒序显示
- 显示访问量和点赞数

#### 留言
**踩一踩**
- 显示历史访问总量
- 显示今日访问量
- 显示最近 10 位访客
- 分享邀请好友来踩

**留言板**
- 显示访客留言记录
- 支持"踩一踩"自动生成留言
- 预设留言内容：
  - "路过，踩踩~"
  - "来串个门，支持下！"
  - "悄悄路过，留个脚印~"
  - "路过来看看，不错哦~"

---

### 2.5 游戏中心

#### 开心农场 (`/pages/farm/index`)
独立页面，使用 `farm-game` 组件。

**游戏玩法**
- 6 块土地，2x2 网格布局
- 种植作物：
  - 🍄 Pixel Shroom (10秒) - 成本 10c，售价 25c
  - 🌹 Bit Rose (30秒) - 成本 30c，售价 80c
  - 🍇 Data Berry (60秒) - 成本 100c，售价 300c
  - 💎 Logic Gem (2分钟) - 成本 500c，售价 1500c
- 点击空地打开商店购买种子
- 点击成熟作物收获
- 访问邻居农场偷菜

**UI 风格**
- Win98 窗口设计
- 复古按钮和进度条
- 状态栏显示连接状态

---

## 3. 云函数架构

### qcio 云函数

**功能**：QCIO 社交平台核心业务

**Actions**:

| Action | 功能 | 数据库操作 |
|--------|------|------------|
| `init` | 初始化账号，生成 QCIO 号 | 读/写 `qcio_users` |
| `login` | 设置在线状态 | 更新 `qcio_users.isOnline` |
| `logout` | 设置离线状态 | 更新 `qcio_users.isOnline` |
| `updateProfile` | 更新昵称/签名 | 更新 `qcio_users` |
| `saveMoodLog` | 保存心情日志 | 写入 `qcio_mood_logs` |
| `getMoodLogs` | 获取日志列表 | 读取 `qcio_mood_logs` |
| `recordVisit` | 记录踩一踩 | 更新 `qcio_users`, 写入 `qcio_guestbook` |
| `getVisitStats` | 获取访问统计 | 读取 `qcio_users` |
| `saveChatHistory` | 保存聊天历史 | 写入 `qcio_chat_history` |
| `getChatHistory` | 获取聊天历史 | 读取 `qcio_chat_history` |

---

## 4. 数据库设计

详见 [数据库设计文档.md](./数据库设计文档.md)

### 核心表

| 表名 | 用途 |
|------|------|
| `qcio_users` | QCIO 账号信息 |
| `qcio_mood_logs` | 心情日志 |
| `qcio_chat_history` | 单人聊天历史 |
| `qcio_guestbook` | 空间留言板 |

---

## 5. UI 设计规范

### 颜色方案
- 背景色：`#008080` (经典桌面蓝绿)
- 窗口背景：`#c0c0c0` (Windows 98 灰)
- 标题栏渐变：`#000080` → `#1084d0`
- 边框高光：`#ffffff`
- 边框阴影：`#808080`

### 字体
- 主字体：`SimSun` (宋体)
- 代码/等宽：`Courier New`

### 尺寸规范
- 标题栏高度：20px
- 按钮高度：24px
- 输入框高度：24px
- 边框宽度：1px

---

## 6. 页面路由

| 路径 | 功能 | 状态栏 |
|------|------|--------|
| `/pages/qcio/index` | QCIO 主面板 | 自定义 |
| `/pages/qcio-chat/index` | 单人聊天 | 自定义 |
| `/pages/group-chat/index` | 群聊 | 自定义 |
| `/pages/farm/index` | 开心农场 | 自定义 |

---

## 7. 开发进度

### 已完成 ✅
- [x] QCIO 主面板 UI
- [x] 账号初始化与 5 位 ID 生成
- [x] 好友列表分组展示
- [x] 个人资料编辑（昵称、签名）
- [x] 空间二级 Tab 导航
- [x] 心情日志发布与列表
- [x] 踩一踩功能（含自动留言）
- [x] 留言板展示
- [x] 开心农场独立页面
- [x] 单人聊天页面
- [x] 群聊页面
- [x] 登录/注销流程

### 待开发 📋
- [ ] 黄钻贵族系统（头像自定义）
- [ ] 空间访问量分享裂变
- [ ] 日志点赞功能
- [ ] 更多 AI 人设
- [ ] 空间背景音乐

---

## 8. 合规说明

### UGC 风险控制
- **个性签名**：可自由编辑，建议接入内容安全检测
- **心情日志**：用户输入内容，建议接入 `security.msgSecCheck`
- **留言板**：目前仅支持系统预设留言，无真实 UGC 风险
- **聊天**：AI 生成内容，无用户对用户直接通信

### 品牌规范
- 使用 **QCIO** 名称（非 QCIQ 或 QQ）
- 明确标注为"怀旧模拟器"，非真实社交软件
- UI 风格致敬但不完全复制经典设计

---

## 9. 版本历史

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12 | 初始版本，核心功能完成 |
