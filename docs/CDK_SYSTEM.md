# CDK系统设计

> 私域变现 + 应用激活 + 功能解锁
>
> 讨论日期：2025-12-26

---

## 一、系统概述

### 核心逻辑

```
你在私域（公众号/社群）售卖CDK
        ↓
用户购买后获得CDK码
        ↓
在小程序内输入CDK激活
        ↓
解锁新应用/新功能
```

### 设计目标

| 目标 | 说明 |
|------|------|
| **私域变现** | 通过公众号/社群售卖CDK |
| **应用激活** | 新应用需要CDK激活 |
| **功能解锁** | 特殊功能需要CDK解锁 |
| **持续收入** | 每次版本更新都可推出新CDK |

---

## 二、CDK类型

### 按用途分类

| 类型 | 用途 | 定价 |
|------|------|------|
| **应用激活码** | 激活新应用 | 9.9-19.9元 |
| **功能解锁码** | 解锁特殊功能 | 4.9-9.9元 |
| **特权码** | 去广告+特权 | 19.9-99.9元 |
| **礼包码** | Q点+装饰+称号 | 4.9-9.9元 |
| **限时码** | 节日/活动限定 | 变动 |

---

### 具体CDK设计

#### 应用激活类

| CDK前缀 | 激活内容 | 售价 |
|---------|---------|------|
| `IFTH-2025` | 如果当时.exe 完整版 | 9.9元 |
| `IFTH-PRO` | 如果当时.exe 精英版（更多结局）| 19.9元 |
| `V2010-XXXX` | 2010年版激活 | 19.9元 |
| `V2015-XXXX` | 2015年版激活 | 19.9元 |

#### 功能解锁类

| CDK前缀 | 解锁内容 | 售价 |
|---------|---------|------|
| `THEME-WINXP` | WinXP主题 | 4.9元 |
| `THEME-WIN7` | Win7主题 | 4.9元 |
| `AI-HIDDEN` | 隐藏AI角色包 | 9.9元 |
| `EGGS-SECRET` | 彩蛋提示手册 | 4.9元 |

#### 特权类

| CDK前缀 | 特权内容 | 售价 |
|---------|---------|------|
| `VIP-MONTH` | 月度特权（去广告+加速）| 9.9元 |
| `VIP-YEAR` | 年度特权 | 49.9元 |
| `VIP-LIFE` | 终身特权 | 99.9元 |

#### 礼包类

| CDK前缀 | 礼包内容 | 售价 |
|---------|---------|------|
| `GIFT-START` | 新手礼包（1000Q点+5个头像）| 4.9元 |
| `GIFT-HOLIDAY` | 节日礼包 | 9.9元 |
| `GIFT-ANNI` | 周年礼包 | 19.9元 |

---

## 三、CDK格式设计

### 格式规范

```
格式：XXXX-XXXX-XXXX-XXXX
示例：MILL-2005-NOST-ALGI
```

### 前缀含义

| 前缀 | 说明 |
|------|------|
| `MILL` | 千禧时光机基础 |
| `IFTH` | 如果当时.exe |
| `QCIO` | QCIO高级版 |
| `V20XX` | 年代版本（V2010/V2015等）|
| `VIP` | 特权会员 |
| `THEME` | 主题 |
| `GIFT` | 礼包 |

---

## 四、系统架构

### 后端设计

```
┌─────────────────────────────────────┐
│          云函数：cdk                 │
├─────────────────────────────────────┤
│  • generate()  生成CDK              │
│  • verify()    验证CDK              │
│  • activate()  激活CDK              │
│  • query()     查询CDK状态          │
│  • batchGenerate() 批量生成          │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│          云数据库：cdks              │
├─────────────────────────────────────┤
│  • _id: CDK码                       │
│  • type: CDK类型                    │
│  • status: 状态                     │
│    - unused: 未使用                 │
│    - activated: 已激活              │
│    - expired: 已过期                │
│  • usedBy: 使用者openid             │
│  • usedAt: 使用时间                 │
│  • createdAt: 创建时间              │
│  • expiresAt: 过期时间              │
│  • metadata: 扩展信息               │
└─────────────────────────────────────┘
```

---

### 数据结构

```javascript
// CDK数据
{
  _id: "IFTH-2025-ABCD-1234",
  type: "app_activation",
  app: "ifthen",
  version: "2025",

  status: "unused", // unused | activated | expired

  // 使用信息
  usedBy: null, // openid
  usedAt: null, // timestamp

  // 时间
  createdAt: "2025-01-01T00:00:00Z",
  expiresAt: "2026-01-01T00:00:00Z",

  // 元数据
  metadata: {
    batch: "batch_001",
    generator: "admin",
    notes: "首批预售"
  }
}
```

---

## 五、前端设计

### 兑换入口

```
设置 → CDK兑换
```

### 兑换页面

```
┌─────────────────────────────────┐
│  🎫 CDK兑换                     │
├─────────────────────────────────┤
│                                 │
│  请输入CDK码：                  │
│  ┌───────────────────────────┐  │
│  │ XXXX-XXXX-XXXX-XXXX       │  │
│  └───────────────────────────┘  │
│                                 │
│  [ 立即兑换 ]                   │
│                                 │
│  ─────────────────────────────  │
│                                 │
│  💡 如何获得CDK？               │
│  → 关注公众号：千禧时光机        │
│  → 加入微信社群                 │
│  → 私聊管理员购买               │
│                                 │
│  📋 CDK价格表                   │
│  [查看详情]                     │
└─────────────────────────────────┘
```

---

### 兑换流程

```
用户输入CDK
    ↓
点击"立即兑换"
    ↓
调用云函数验证CDK
    ↓
┌────────┐
│ 有效？  │
└────┬───┘
     ↓
    是 ↓ 否
   激活 ↓ 提示无效
   成功 ↓
显示奖励
```

---

## 六、私域售卖流程

### 完整流程

```
用户在小程序看到"CDK兑换"
    ↓
引导去公众号/社群
    ↓
在私域查看CDK价格表
    ↓
私聊管理员购买
    ↓
微信转账/红包支付
    ↓
管理员发送CDK码
    ↓
用户在小程序兑换激活
```

---

### 价格表展示（公众号）

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        千禧时光机 CDK商店
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【应用激活】
• 如果当时.exe 激活码     ¥ 9.9
• 如果当时.exe 精英版     ¥ 19.9

【功能解锁】
• WinXP 主题              ¥ 4.9
• 隐藏AI角色包            ¥ 9.9
• 彩蛋提示手册            ¥ 4.9

【特权会员】
• 月度特权（去广告）       ¥ 9.9
• 年度特权                ¥ 49.9
• 终身特权                ¥ 99.9

【礼包】
• 新手礼包（1000Q点）     ¥ 4.9
• 节日礼包                ¥ 9.9

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
购买方式：私聊管理员
支付方式：微信转账/红包
售后说明：虚拟商品，购买后不退
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### 自动回复（公众号）

```
用户发送："CDK" 或 "兑换"

自动回复：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📦 千禧时光机 CDK商店

【查看价格】
点击查看完整CDK价格表

【购买CDK】
私聊管理员：[管理员微信号]

【已购买？】
点击这里打开小程序兑换

【常见问题】
Q: CDK怎么用？
A: 打开小程序→设置→CDK兑换→输入CDK

Q: CDK有有效期吗？
A: 大部分CDK有效期1年

Q: 可以退款吗？
A: 未使用的CDK可退款，已使用不退
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 七、管理工具

### CDK生成工具（仅管理员）

```javascript
// 云函数：cdk/admin
// 管理员权限验证

// 生成单个CDK
generateCDK({
  type: 'app_activation',
  app: 'ifthen',
  quantity: 1
})
// 返回: "IFTH-2025-ABCD-1234"

// 批量生成CDK
batchGenerateCDK({
  type: 'gift_pack',
  quantity: 100,
  batch: 'batch_001'
})
// 返回: 100个CDK列表

// 查询CDK状态
queryCDK('IFTH-2025-ABCD-1234')
// 返回: {status, usedBy, usedAt, ...}
```

### 管理面板（可后续开发）

```
┌─────────────────────────────────┐
│  CDK管理面板                     │
├─────────────────────────────────┤
│                                 │
│  [生成CDK] [查询CDK] [导出列表]  │
│                                 │
│  统计：                          │
│  • 总生成：500个                 │
│  • 已使用：328个                 │
│  • 未使用：172个                 │
│  • 已过期：0个                   │
│                                 │
│  最近生成：                      │
│  • IFTH-2025-xxxx (10个)         │
│  • GIFT-START-xxxx (50个)        │
│                                 │
└─────────────────────────────────┘
```

---

## 八、防滥用设计

### 限制机制

| 限制 | 说明 |
|------|------|
| **一人一码** | 每个CDK只能绑定一个用户 |
| **使用时效** | 激活后7天内必须使用 |
| **设备绑定** | 激活后绑定设备，不可转移 |
| **有效期** | CDK有有效期（通常1年）|

---

### CDK状态流转

```
生成 → 未使用
   ↓
激活 → 已激活
   ↓
使用 → 已完成
   ↓
过期 → 已过期（未使用情况下）
```

---

### 退款规则

| 情况 | 退款 |
|------|------|
| 未使用 | 可退款 |
| 已激活但未使用 | 可退款（扣除手续费）|
| 已使用 | 不退款 |

---

## 九、营销策略

### 新应用发布

```
1. 免费体验版（功能受限）
2. 完整版需要CDK激活
3. 前100名半价优惠
4. 公众号/社群首发
```

---

### 活动CDK

| 活动 | CDK | 优惠 |
|------|-----|------|
| **节日限定** | 特定格式 | 限时半价 |
| **粉丝回馈** | 群内抽奖 | 免费送 |
| **内测奖励** | 内测用户 | 免费送 |
| **邀请奖励** | 邀请X好友 | 送CDK |

---

### 限量CDK

| 类型 | 数量 | 溢价 |
|------|------|------|
| **珍藏版** | 100个 | 特殊编号 |
| **签名版** | 50个 | 开发者签名 |
| **纪念版** | 200个 | 特殊日期 |

---

## 十、收入预估

### 假设场景

| 项目 | 数值 |
|------|------|
| 用户数 | 10,000 |
| 付费率 | 3% |
| 客单价 | 15元 |

### 收入计算

```
月收入 = 10,000 × 3% × 15 = 4,500元
年收入 = 4,500 × 12 = 54,000元
```

### 乐观场景

| 项目 | 数值 |
|------|------|
| 用户数 | 10,000 |
| 付费率 | 5% |
| 客单价 | 20元 |

```
年收入 = 10,000 × 5% × 20 × 12 = 120,000元
```

---

## 十一、合规注意

### 个人主体限制

| 问题 | 解决方案 |
|------|---------|
| 不能微信支付 | 私域转账（不通过小程序）|
| 不能开发票 | 个人转账，不开票 |
| 售后纠纷 | 制定明确规则 |

### 交易说明模板

```
【购买须知】
1. 虚拟商品，购买后不退不换（特殊情况除外）
2. 请确认CDK类型后再购买
3. 激活后绑定账号，不可转移

【发货说明】
1. 购买后24小时内发货
2. CDK通过私聊发送
3. 请妥善保管CDK码

【使用说明】
1. 打开小程序 → 设置 → CDK兑换
2. 输入CDK码 → 点击兑换
3. 激活成功后即可使用
```

---

## 十二、开发优先级

### 第一阶段：基础系统

| 功能 | 优先级 | 说明 |
|------|--------|------|
| CDK云函数 | 🔴 高 | 生成、验证、激活 |
| CDK数据库 | 🔴 高 | 存储CDK数据 |
| 兑换页面 | 🔴 高 | 用户输入界面 |
| 管理工具 | 🔴 高 | 管理员生成CDK |

---

### 第二阶段：商业化

| 功能 | 优先级 | 说明 |
|------|--------|------|
| 第一个付费CDK | 🔴 高 | 应用激活 |
| 私域售卖流程 | 🔴 高 | 价格表、自动回复 |
| 营销活动 | 🟡 中 | 限量、优惠 |

---

### 第三阶段：扩展

| 功能 | 优先级 | 说明 |
|------|--------|------|
| 多种CDK类型 | 🟡 中 | 功能解锁、特权等 |
| 限时CDK | 🟢 低 | 节日限定 |
| 管理面板 | 🟢 低 | 可视化管理 |

---

> CDK是私域变现的桥梁，用得好可以成为稳定的收入来源。
>
> © 2025 千禧时光机 · CDK系统
