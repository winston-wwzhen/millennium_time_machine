# 千禧时光机 (old_story)

> 重现 2006 年千禧年代的怀旧小程序

一个充满非主流、火星文、伤感情怀的微信小程序，带你回到千禧年代的互联网记忆。

---

## 项目简介

"千禧时光机"是一个复古风格的社交模拟小程序，模拟 Windows 98 桌面和 2006 年左右的社交空间、聊天体验。用户可以：

- **Windows 98 桌面** - 怀旧的操作系统界面，可拖拽的小狮子助手
- **网上邻居** - 模拟拨号上网，连接后才能使用 AI 功能
- **创建 5 位数字的 QCIO 账号**（5位数字社交账号）
- 与 100 个 AI 网友聊天，每个都有独特的个性
- 加入 6 个 AI 群聊，体验群聊氛围
- 发布空间心情日志
- 玩心情农场小游戏
- 浏览他人空间，踩一踩留言
- 邀请好友访问自己的空间
- **内置小游戏** - 星际探索、火星翻译等

---

## 功能特性

### Windows 98 桌面系统

| 功能 | 说明 |
|------|------|
| 桌面图标 | 我的电脑、网管系统、我的文档、回收站、浏览器、QCIO、非主流相机 |
| 开始菜单 | 程序子菜单（小游戏）、设置、帮助、关机 |
| 任务栏 | Start 按钮、运行任务显示、系统托盘（网络状态、音量切换、时间） |
| 欢迎弹窗 | 首次打开显示"时间穿越成功"主题，带怀旧叙事引导 |
| 网管系统 | 双代币管理、拨号连接模拟、时光币兑换网费 |
| 网管插件 | 右上角便利贴样式，实时显示网费和时光币余额 |
| 网络状态 | 右下角显示连接状态，断网时需要通过网管系统重连 |
| AI 错误处理 | 429、超时等错误提示为"网络断开"，引导用户重连 |
| 小狮子助手 | 可拖拽的桌面助手，随机互动消息 |
| 动态层级 | 最后打开的桌面组件自动显示在最上层 |
| 音量切换 | 点击任务栏音响图标切换静音/开启声音，状态持久化 |

### 双代币系统

**游戏循环**：
1. 新用户注册获得 30 天免费网费（43,200 分钟）
2. 每日登录自动扣除 1 天网费（1,440 分钟）
3. 探索桌面发现彩蛋，获得时光币奖励
4. 在网管系统用时光币兑换更多网费
5. 使用网费解锁 AI 聊天等功能

| 代币 | 获取方式 | 用途 |
|------|----------|------|
| 💎 时光币 | 发现彩蛋奖励 | 兑换网费、CDK等 |
| 🌐 网费 | 初始30天、时光币兑换 | AI 功能消耗 |

**兑换比例**: 1000 时光币 = 1 天网费 (1 时光币 ≈ 1.44 分钟)

**彩蛋系统**：
- 23 个隐藏彩蛋，分布在桌面各处
- 不同稀有度：普通(13)、稀有(8)、史诗(1)、传说(1)
- 奖励 400-10000 时光币不等
- 成就徽章收集
- 云端存储，跨设备同步

### 桌面应用

| 应用 | 图标 | 说明 |
|------|------|------|
| 我的电脑 | 💻 | Win98 风格窗口，显示系统信息和驱动器 |
| 网管系统 | ⚙️ | 双代币管理、时光币兑换网费、拨号连接 |
| 我的文档 | 📁 | Win98 风格文件管理器 |
| 回收站 | 🗑️ | 回收站界面 |
| 浏览器 | 🌐 | 千禧浏览器，内置6款2006风格工具 |
| QCIO | 📟 | QCIO 社交空间 |
| 非主流相机 | 📸 | 头像生成器 |

**开始菜单 - 程序子菜单**：
- 如果当时 🎮 - 人生模拟游戏
- 星际探索 🌌
- 火星翻译 🪐

### "如果当时"人生模拟游戏

穿越回2006年，经历20年人生旅程，通过选择走向不同结局。

**游戏特色**：
| 特性 | 说明 |
|------|------|
| 时间跨度 | 2006-2026年，20年人生旅程 |
| 历史事件 | 2006-2026年真实历史事件互动 |
| 结局数量 | 88种不同人生结局 |
| 结局类型 | 特殊/传奇、好结局、普通结局、坏结局 |
| 属性系统 | 技术、社交、财富、健康、快乐、魅力、运气、学识 |
| 叙事系统 | 年度叙事 + 年龄叙事，增强代入感 |
| 视觉风格 | Win98复古风格，打字机效果 |

**游戏流程**：
1. 选择出生年份（1940-2006）和性别
2. 从2006年开始，经历20年人生旅程
3. 遇到历史大事件时，需要做出选择
4. 每次选择都会影响人物属性
5. 最终属性决定你的人生结局
6. 收集所有结局，解锁不同人生可能

**结局示例**：
- 🌟 特殊/传奇结局：互联网大亨、顶级网红、QCIO创始人、AI先驱
- 😊 好结局：技术专家、成功高管、自由职业者、创业成功
- 😐 普通结局：平凡人生、普通打工人、返乡青年、自由设计师
- 😢 坏结局：过劳、股灾受害者、孤独终老、健康危机

### QCIO 社交系统

| 功能 | 说明 |
|------|------|
| 账号系统 | 5 位数字账号（10000-99999），固定密码 123456 |
| 个人资料 | 昵称、头像、签名、等级、在线状态 |
| 空间系统 | 访问量统计、访客记录、留言板 |
| 好友系统 | 从 100 个 AI 网友中随机分配 20 个好友 |
| 踩一踩 | 每天可踩好友空间，自动留言互动 |
| 邀请访问 | 分享链接邀请好友踩空间 |
| 访客页面 | 独立访问页面，查看他人空间 |

### QCIO 农场系统

**混合种植模式**：传统作物 + 心情作物双轨并行

| 功能 | 说明 |
|------|------|
| 入口位置 | QCIO 空间主页 |
| 土地系统 | 初始6块，升级解锁更多（最多24块） |
| 农场等级 | 独立等级系统，种植获得经验 |
| 农场记录 | 完整的种植/收获/购买日志 |
| Win98风格 | 复古窗口界面，3D边框效果 |

**传统作物**（周期短，收益稳定）：

| 作物 | 成本 | 售价 | 周期 | 经验 |
|------|------|------|------|------|
| 小麦 🌾 | 10金币 | 25金币 | 30秒 | 5 |
| 玉米 🌽 | 20金币 | 55金币 | 60秒 | 8 |
| 番茄 🍅 | 50金币 | 150金币 | 2分钟 | 12 |
| 南瓜 🎃 | 100金币 | 350金币 | 5分钟 | 20 |
| 草莓 🍓 | 200金币 | 700金币 | 10分钟 | 35 |
| 棉花 🌿 | 300金币 | 1200金币 | 30分钟 | 50 |
| 向日葵 🌻 | 500金币 | 2500金币 | 2小时 | 80 |
| 葡萄 🍇 | 800金币 | 5000金币 | 6小时 | 150 |
| 苹果 🍎 | 1200金币 | 9000金币 | 12小时 | 250 |
| 人参 🌱 | 2000金币 | 20000金币 | 24小时 | 500 |

**心情作物**（周期长，高收益）：

| 作物 | 成本 | 售价 | 周期 | 经验 |
|------|------|------|------|------|
| 忧伤.exe 😢 | 5金币 | 15金币 | 1分钟 | 3 |
| 寂寞.bat 😔 | 10金币 | 35金币 | 30分钟 | 8 |
| 初恋.dll 💕 | 20金币 | 80金币 | 1小时 | 15 |
| 记忆.dat 🧠 | 100金币 | 500金币 | 3小时 | 50 |
| 梦境.exe 💭 | 200金币 | 1500金币 | 12小时 | 150 |
| 命运.dll ✨ | 500金币 | 5000金币 | 24小时 | 400 |

**装饰系统**：

| 装饰 | 成本 | 效果 |
|------|------|------|
| 木栅栏 🚧 | 100金币 | 无 |
| 金栅栏 ✨ | 500金币 | 产量+10% |
| 稻草人 🎭 | 200金币 | 被偷概率-20% |
| 喷灌系统 ⛲ | 1000金币 | 生长速度+15% |

**农场等级系统**：

| 等级 | 所需经验 | 解锁土地 |
|------|----------|----------|
| Lv.1 | 0 | 6块 |
| Lv.2 | 100 | 6块 |
| Lv.3 | 300 | 9块 |
| Lv.5 | 800 | 12块 |
| Lv.10 | 3000 | 15块 |
| Lv.15 | 8000 | 18块 |
| Lv.20 | 15000 | 21块 |
| Lv.30 | 50000 | 24块 |

**深度集成**：
- 收获获得金币 + 农场经验
- 使用QCIO钱包购买种子/装饰
- 农场记录追踪所有操作

### AI 聊天系统

**36 种聊天模式**，包括但不限于：

| 模式 | 风格 | 示例 |
|------|------|------|
| qingwu | 轻舞飞扬（非主流） | "滴~ 莪湜輕舞飛颺..." |
| sadsoul | 忧郁王子 | "唉，夜空中的星星好寂寞..." |
| netadmin | 网管小哥 | "重启试试" |
| fortune_teller | 算命大师 | "卦象显示..." |
| mars | 火星文转换 | 输入"你好" -> "伱好ㄋ" |
| joker | 段子手 | 输出搞笑段子 |

**100 个 AI 网友**，分为 12 个分组：

| 分组 | 人数 | 风格 |
|------|------|------|
| 葬爱家族 | 22人 | 非主流火星文 |
| 网游开黑 | 6人 | 游戏爱好者 |
| 网吧常驻 | 6人 | 技术、网吧 |
| 网络评论家 | 7人 | 键盘侠、吐槽 |
| 神秘人士 | 9人 | 玄学、中二 |
| 情感咨询 | 6人 | 恋爱、八卦 |
| 学霸联盟 | 7人 | 学习、技术 |
| 文艺青年 | 8人 | 诗歌、古风 |
| 娱乐达人 | 7人 | 电影、音乐 |
| 佛系一族 | 5人 | 禅意、极简 |
| 普通人 | 7人 | 日常生活 |
| 工具人 | 10人 | 转换功能 |

### 群聊系统

**6 个群聊**，每个群 18-24 人：

| 群名 | 人数 | 风格 |
|------|------|------|
| 葬爱网游家族 | 24人 | qingwu |
| 网吧技术联盟 | 20人 | netadmin |
| 神秘学园 | 20人 | fortune_teller |
| 情感八卦圈 | 21人 | love_expert |
| 学霸文艺社 | 19人 | nerd |
| 普通生活馆 | 18人 | down_to_earth |

**群聊发言机制**：
- 每次发消息随机选择 1-6 个群成员回复
- 概率分布：1人40%、2人30%、3人15%、4人8%、5人5%、6人2%
- AI 回复之间有 0.8-1.8 秒随机延迟

### 踩一踩系统

- **每日限制**：每个用户每天只能踩同一空间一次
- **自动留言**：踩过后自动在对方留言板生成随机留言
- **访客统计**：记录历史访问量和今日访问量
- **最近访客**：显示最近 10 位访客信息
- **分享功能**：可分享自己的空间链接给好友

---

## 技术架构

### 前端技术

- **框架**: 微信小程序原生框架
- **语言**: WXML + WXSS + JavaScript
- **UI**: 复古风格，模拟 QQ 2006 界面

### 后端技术

- **云开发**: 微信云开发 (wx-server-sdk)
- **云函数**:
  - `user` - 用户登录和管理
  - `qcio` - QCIO 社交功能
  - `chat` - AI 聊天核心
  - `mood_logic` - 心情农场游戏
  - `ifthen` - "如果当时"游戏数据存储

### AI 能力

- **模型**: 智谱 AI GLM 系列
- **温度参数**: 根据模式动态调整 (0.2-0.95)
- **上下文**: 最近 20 条消息

---

## 数据库设计

### 核心数据表

| 表名 | 用途 |
|------|------|
| users | 用户双代币系统（时光币、网费）、彩蛋收集 |
| qcio_users | QCIO 账号信息 |
| qcio_ai_contacts | AI 好友列表（100个）|
| qcio_groups | 群聊列表（6个）|
| qcio_mood_logs | 用户心情日志 |
| qcio_chat_history | 单人聊天历史 |
| qcio_group_chat_history | 群聊历史 |
| qcio_guestbook | 空间留言板 |
| qcio_daily_tasks | 每日任务（踩一踩记录）|
| qcio_wallet | 用户钱包（金币、Q点）|
| qcio_achievements | 成就系统 |
| qcio_farm_profiles | 农场档案（等级、经验、土地数量）|
| qcio_farm_plots | 土地状态（作物信息、生长进度）|
| qcio_farm_inventory | 仓库（种子、作物、装饰）|
| qcio_farm_logs | 农场操作记录 |
| mood_garden | 心情农场状态 |
| ifthen_endings | 用户获得的结局记录 |
| ifthen_play_history | 游戏游玩历史 |

---

## 安全机制

### 内容安全检测

使用微信 `msgSecCheck` API 进行内容安全校验：

- 输入检测：用户发送消息时
- 输出检测：AI 生成回复时

### 发送频率限制

| 限制项 | 数值 |
|--------|------|
| 冷却时间 | 2 秒 |
| 最大输入长度 | 50 字 |

### 数据隔离

- 所有云函数通过 `cloud.getWXContext()` 获取用户 openid
- 数据查询使用 `.where({ _openid: OPENID })` 确保隔离

---

## 项目结构

```
old_story/
├── cloudfunctions/       # 云函数
│   ├── chat/            # AI 聊天核心
│   ├── qcio/            # QCIO 社交功能
│   │   └── modules/     # 功能模块
│   │       ├── wallet.js       # 钱包模块
│   │       ├── dailyTasks.js   # 每日任务
│   │       ├── achievements.js # 成就系统
│   │       ├── moodLog.js      # 心情日志
│   │       ├── guestbook.js    # 留言板
│   │       └── farm.js         # 农场系统
│   ├── user/            # 用户管理
│   ├── admin-stats/     # 管理后台数据统计
│   └── mood_logic/      # 心情农场
├── miniprogram/         # 小程序前端
│   ├── pages/           # 页面
│   │   ├── index/       # Windows 98 桌面主页
│   │   ├── chat/        # 单人聊天
│   │   ├── group-chat/  # 群聊
│   │   ├── ifthen/      # "如果当时"人生模拟游戏
│   │   │   ├── start/   # 游戏开始页
│   │   │   ├── timeline/ # 游戏时间线页
│   │   │   └── history/ # 结局收集页
│   │   ├── qcio/        # QCIO 主页
│   │   │   ├── visit/   # 访问他人空间页面
│   │   │   ├── farm/    # QCIO农场系统
│   │   │   └── components/ # QCIO 组件
│   │   ├── qcio-chat/   # QCIO 聊天
│   │   ├── farm/        # 心情农场
│   │   ├── network-neighborhood/ # 网管系统（双代币、兑换）
│   │   ├── my-computer/ # 我的电脑
│   │   ├── my-documents/ # 我的文档
│   │   ├── recycle-bin/ # 回收站
│   │   ├── browser/     # 浏览器
│   │   ├── star-explorer/ # 星际探索
│   │   ├── mars/        # 火星翻译
│   │   ├── avatar/      # 非主流相机
│   │   └── about/       # 关于页面
│   ├── data/            # 游戏数据
│   │   ├── ifthen-events.js     # 历史事件数据
│   │   ├── ifthen-endings.js    # 结局数据（88种）
│   │   └── ifthen-narratives.js # 日常叙事数据
│   ├── utils/           # 工具函数
│   │   ├── network.js   # 网络状态管理
│   │   └── prevent-duplicate.js # 防重复点击
│   └── components/      # 通用组件
├── admin-panel/         # 管理后台
│   ├── src/             # 源代码
│   │   ├── views/       # 页面组件
│   │   ├── api/         # API 调用
│   │   └── router/      # 路由配置
│   ├── dist/            # 构建产物
│   └── server.js        # Express 服务器
├── docs/                # 文档
│   ├── README.md        # 项目说明
│   ├── EGG_LIST.md      # 彩蛋列表（23个彩蛋完整触发指南）
│   ├── FUNCTIONS.md     # 功能说明
│   └── GAMEPLAY.md      # 玩法说明
└── cloudfunctions/      # 云函数
    └── init-db/         # 数据库初始化（含AI数据和群组数据）
```

---

## 更新日志

### v3.8 (2025-12-30)
- ✨ 彩蛋大全动态加载：自动从EGG_IDS加载所有彩蛋，显示总数（X/33格式）
- 🗑️ 移除我的电脑中的彩蛋相关文件：清理不规范彩蛋文件和方法
- 🎮 优化如果当时游戏体验：移除事件弹窗关闭按钮，防止用户卡住
- 🎨 优化我的电脑容量显示：空间充足时使用深灰色而非红色
- 📱 优化浏览器快捷导航：支持横向滚动，适配小屏幕手机

### v3.7 (2025-12-29)
- 🐛 修复 RECYCLE_BIN_EMPTYER 彩蛋缺失定义问题
- 📝 更新彩蛋文档：23个彩蛋完整列表，按位置和稀有度分类
- 🔧 完善回收站彩蛋触发逻辑（组件和页面双版本）

### v3.6 (2025-12-29)
- ✨ 浏览器内部工具系统：6个工具全部实现在浏览器内部，无需跳转页面
- ✨ 千禧浏览器内置工具：火星翻译、非主流相机、星际探索、在线计算器、天气预报、万年历
- ✨ 2006风格工具页面：每个工具都有独特的2006年代网站风格设计
- ✨ 完整功能实现：星际探索3难度扫雷游戏、计算器、天气模拟、日历查询
- ✨ 彩蛋系统集成：浏览器内的火星翻译和非主流相机可正常触发彩蛋
- ✨ 内部导航系统：浏览器前进/后退/刷新按钮支持所有工具页面

### v3.5 (2025-12-28)
- ✨ 浏览器页面重设计：完整实现2006风格门户网站（千禧导航 navi-2006.com）
- ✨ 浏览器功能优化：刷新按钮旋转动画效果
- ✨ 合规性优化：域名从 hao2006.com 改为 navi-2006.com，避免品牌混淆
- ✨ 用户体验优化：添加"仅为怀旧风格展示"说明，修改"按Ctrl+D收藏"为"欢迎收藏本站"
- ✨ 页面内容优化：单栏布局适配手机屏幕，快捷工具一行展示

### v3.4 (2025-12-28)
- ✨ 新增彩蛋秘籍第二册：回收站随机生成特殊文件（20%概率），可还原到彩蛋文件夹
- ✨ 彩蛋秘籍第一册永久显示：查看后自动保持显示状态，无需再次触发
- ✨ QCIO头像修改：支持16种emoji头像选择，点击头像即可更换
- ✨ 内容安全检测：昵称修改前调用微信msgSecCheck API进行内容审核
- 🔧 移除签名编辑功能：暂不开放用户修改个性签名
- 🐛 修复经验进度条显示为0的bug：修正进度计算公式
- 🔧 回收站从页面转换为组件，优化代码结构

### v3.3 (2025-12-28)
- ✨ 新增我的电脑帮助弹窗：Win98风格，包含驱动器说明和系统信息
- 🔧 移除非功能性菜单栏：我的电脑、我的文档等窗口的菜单按钮
- 📝 文案合规性调整：移除"QQ"、"腾讯"等商标引用，改用"QCIO"或通用描述
- 📝 更新CLAUDE.md：添加开发规范章节（弹窗风格、数据库表管理）
- ✨ 新增clear-db云函数：支持一键清空所有数据库，方便测试
- 🔧 完善init-db云函数：补充缺失的5个数据表
- 🔧 数据库表总数：32个集合

### v3.2 (2025-12-28)
- ✨ 新增QCIO农场系统：深度集成QCIO生态的混合农场
- ✨ 双轨种植：传统作物（小麦、玉米、番茄、南瓜、草莓）+ 心情作物（忧伤.exe、寂寞.bat、初恋.dll）
- ✨ 农场等级：独立等级系统，种植获得经验升级解锁更多土地
- ✨ 商店系统：购买种子和装饰（金栅栏、稻草人、喷灌系统等）
- ✨ Win98风格界面：复古窗口、3D边框、土地网格布局
- 🔧 深度集成：共用钱包/等级/每日任务系统
- 🔧 农场收获获得金币+经验，计入每日任务

### v3.1 (2025-12-28)
- ✨ 新增QCIO等级系统：经验获取、升级机制、等级称号
- ✨ 新增等级奖励系统：里程碑等级每日奖励（Lv5/10/15/20/25/30/35）
- ✨ 新增聊天经验获取：每条消息 +2 经验，每日上限 100
- ✨ 新增经验来源：发布日志、访问空间、农场收获、每日签到
- 🐛 修复level云函数查询问题（where方式替代doc查询）
- 🐛 修复等级奖励按钮显示逻辑（只显示有奖励的等级）
- 🐛 修复聊天震动强度（heavy改为light）
- 🔧 优化数据库初始化云函数（支持数据导入）
- 🔧 删除未使用的页面文件

### v3.0 (2025-12-27)
- ✨ 新增网管系统插件：右上角便利贴样式，显示网费和时光币余额
- ✨ 新增音量切换功能：点击任务栏音响图标可切换静音/开启声音
- ✨ 新增动态z-index管理：最后打开的桌面组件自动显示在最上层
- ✨ 新增我的文档帮助窗口：Win98风格，包含完整使用说明
- 🎨 优化网管插件样式：纸质便利贴风格，低饱和度米色，不显眼
- 🎨 优化桌面组件层级管理：我的电脑、我的文档、网管系统支持z-index动态调整
- 🐛 修复彩蛋文件命名：彩蛋秘籍1.txt → 彩蛋秘籍-第一册.txt
- 🐛 移除我的文档中的QQ空间图标（已有独立入口）
- 📝 完善项目文档，更新功能说明

### v2.9 (2025-12-27)
- 🎨 网管系统UI优化：移除菜单栏（文件、编辑、查看、帮助）
- 🎨 统一对话框高度：兑换网费、扣费记录对话框高度一致
- 🎨 兑换成功弹窗升级为Win98风格自定义对话框
- 🎨 时光币不足提示升级为Win98风格自定义对话框
- 🎨 优化所有对话框关闭按钮样式，使用标准Win98样式
- 🎨 优化按钮尺寸和配色，提升视觉效果
- 🐛 修复时光币不足时点击无反应的问题

### v2.8 (2025-12-27)
- ✨ 新增随机用户名生成系统（形容词+名词+数字格式）
- 🐛 修复数据库_openid字段缺失导致历史记录查询失败的问题
- 🐛 修复关闭窗口导致重复页面的导航问题（使用navigateBack替代redirectTo）
- 🎨 统一所有页面窗口高度为96%（start/timeline/history）
- 🎨 优化开始页面标题区域布局，合并文字模块
- 🎨 新增用户昵称在开始页面顶部的显示
- 🎨 历史记录页面结局详情弹窗升级为Win98风格
- 🎨 历史记录页面隐藏默认导航栏，使用Win98风格控制按钮
- 📝 完善用户信息加载机制，从数据库获取avatarName

### v2.7 (2025-12-27)
- ✨ 新增"如果当时"人生模拟游戏
- 🎮 穿越回2006年，经历20年（2006-2026）人生旅程
- 📖 88种不同的人生结局（特殊、好、普通、坏结局）
- 🌟 2006-2026年真实历史事件互动
- 💫 日常成长叙事系统，增强代入感
- 🎨 Win98复古风格界面设计
- 📊 结局收集系统，追踪完成度
- ☁️ 云函数结局数据存储

### v2.6 (2025-12-26)
- ✨ 新增双代币系统（时光币 + 网费）
- ✨ 新增桌面彩蛋系统（12个隐藏彩蛋，云端存储）
- ✨ "网上邻居"升级为"网管系统"，支持时光币兑换网费
- 🎮 新用户获得30天免费网费，每日自动扣除1天
- 🎮 探索桌面发现彩蛋，获得时光币奖励
- 🎮 时光币可在网管系统兑换更多网费
- 📊 彩蛋收集进度追踪，成就徽章系统
- 🎨 Win98风格兑换对话框，支持多种套餐

### v2.5 (2025-12-26)
- ✨ 新增管理后台系统 (Vue 3 + Element Plus)
- ✨ 新增 admin-stats 云函数（数据统计）
- 📊 管理后台功能：仪表盘、用户管理、排行榜、创作中心、CDK管理
- 🔧 管理后台部署：Express 服务器 + Nginx 反向代理

### v2.4 (2025-12-25)
- ✨ 优化系统时间弹窗为 Windows 风格日历弹窗（右下角弹出）
- ✨ 新增日历网格显示，支持查看当月所有日期
- ✨ 日期弹窗显示当前时间、星期、农历模拟信息
- 🎨 统一年份为 2006 年（千禧时光机主题）
- 🎨 非主流相机移除"编辑"菜单，优化"帮助"菜单弹窗
- 📝 完善帮助文档说明（基本操作、边框滤镜、装饰功能、小技巧）

### v2.3 (2025-12-25)
- ✨ 优化签到成功弹窗为 Win98 风格自定义对话框
- ✨ 优化注销确认弹窗为 Win98 风格自定义对话框
- ✨ 暂时隐藏农场入口（代码已注释保留）
- 🎨 所有弹窗统一使用 Win98 视觉风格（渐变标题栏、3D 边框、经典按钮）

### v2.2 (2025-12-25)
- ✨ 新增 Windows 98 风格桌面系统
- ✨ 新增网上邻居功能（拨号连接模拟）
- ✨ 新增网络状态管理和错误处理机制
- ✨ 新增小狮子桌面助手（可拖拽互动）
- ✨ 新增开始菜单（带程序子菜单）
- ✨ 优化桌面图标布局（游戏移至开始菜单）
- ✨ 新增任务栏系统托盘（网络状态图标）
- ✨ AI 错误包装（429/超时 → "网络断开"提示）
- 🐛 修复帮助菜单跳转（现跳转至 about/index）
- 🐛 添加点击外部关闭开始菜单功能
- 📝 完善项目文档

### v2.1 (2025-12-25)
- ✨ 新增独立访问页面 (`pages/qcio/visit`)
- ✨ 完善踩一踩系统，每日限制功能
- ✨ 自动留言功能
- ✨ 分享邀请功能
- ✨ 访客统计与最近访客展示
- 🐛 修复关闭按钮样式问题
- 🐛 修复页面返回逻辑
- 📝 完善项目文档

### v2.0 (2025-01)
- QCIO 社交系统完整上线
- 36 种 AI 聊天模式
- 100 个 AI 网友，12 个分组
- 6 个群聊，随机发言机制
- 内容安全检测、频率限制
- 心情农场游戏

### v1.5 (2024-12)
- 千禧浏览器功能
- 火星文翻译器
- 非主流头像生成器
- 星域探险游戏

### v1.0 (2024-12)
- 初始版本发布

---

## 开发指南

### 环境准备

1. 安装微信开发者工具
2. 创建云开发环境
3. 配置 GLM API Key

### 云函数部署

```bash
# 在云函数目录右键 -> 上传并部署
cloudfunctions/chat/
cloudfunctions/qcio/
cloudfunctions/user/
cloudfunctions/mood_logic/
cloudfunctions/ifthen/
```

### 数据库初始化

有两种方式初始化数据库：

#### 方式一：使用 init-db 云函数（推荐）

1. 部署 `cloudfunctions/init-db/` 云函数
2. 在云开发控制台调用云函数：
   ```javascript
   { action: 'init' }  // 创建所有集合并导入数据
   ```
3. 等待初始化完成，会自动创建19个集合并导入AI联系人和群组数据

#### 方式二：手动创建集合

需要创建以下数据库集合：

```javascript
// 用户相关
qcio_users
qcio_wallet
qcio_daily_tasks
qcio_achievements
qcio_mood_logs
qcio_experience_logs
qcio_user_level_rewards
qcio_visit_stats
qcio_space_logs

// 社交相关
qcio_ai_contacts
qcio_groups
qcio_chat_history
qcio_group_chat_history
qcio_guestbook

// 游戏相关
mood_garden

// "如果当时"游戏相关
ifthen_endings
ifthen_play_history
```

数据已集成在 `init-db` 云函数中，推荐使用云函数自动导入。

---

## 管理后台

管理后台是基于 Vue 3 + Element Plus 构建的 Web 管理系统。

### 功能模块

| 模块 | 说明 |
|------|------|
| 仪表盘 | 用户数据统计、活跃度趋势 |
| 用户管理 | 用户列表、详情查看 |
| 排行榜 | 等级/Q点/彩蛋排行榜 |
| 创作中心 | 排行榜海报生成、AI文案生成 |
| CDK管理 | CDK生成、查看、删除 |

### 部署方式

管理后台部署在服务器独立端口（默认 6688）：

```bash
cd admin-panel
npm install
npm run build
npm run server  # 启动 Express 服务器
```

访问地址：`http://服务器IP:6688`

默认账号：`admin` / `admin123`

### 云函数

管理后台依赖 `admin-stats` 云函数获取数据，部署方式：

1. 微信开发者工具 → 右键 `cloudfunctions/admin-stats`
2. 选择「上传并部署：云端安装依赖」

---

## 常见问题

**Q: 为什么老用户看不到好友？**

A: 老用户可能缺少 `myContacts` 字段。系统会在登录时自动检测并补充分配。

**Q: 群聊显示的成员数不对？**

A: 需要重新导入 `db-init/qcio_groups/groups_import.json` 数据到数据库。

**Q: AI 回复很慢？**

A: 这是正常的，模拟了 2006 年拨号上网的延迟感（开玩笑，实际是 API 调用时间）。

**Q: 踩一踩没有生成留言？**

A: 确保已重新上传 `qcio` 云函数，并且数据库中存在 `qcio_guestbook` 集合。

**Q: 访问页面返回按钮无效？**

A: 已修复，现在会智能判断页面栈，无上一页时返回首页。

---

## 许可证

本项目仅供学习和娱乐使用。

---

## 致敬

本项目致敬：
- QQ 2006 / QQ 空间
- 非主流文化
- 葬爱家族
- 杀马特帝国
- 千禧年代的互联网记忆

> "承諾、絠什嚒用？還bùsんì洅見。"
