<view class="desktop">
  <view class="window-frame chat-main">
    <!-- 标题栏 -->
    <view class="title-bar chat-title-bar">
      <view class="title-text">{{groupName}} ({{memberCount}}人)</view>
      <view class="btn-close" bindtap="goBack">×</view>
    </view>

    <!-- 提示信息 -->
    <view class="warning-tip">⚠️ 这是AI群聊，成员随机发言，仅供娱乐</view>

    <!-- 聊天记录区 -->
    <scroll-view class="chat-history" scroll-y="true" scroll-into-view="{{scrollToView}}">
      <block wx:for="{{chatList}}" wx:key="index">
        <!-- AI消息（带发言者名字） -->
        <view class="chat-item left" wx:if="{{item.type === 'ai'}}">
          <view class="avatar ai-avatar">{{groupAvatar}}</view>
          <view class="message-content">
            <view class="speaker-name">{{item.speakerName}}</view>
            <view class="bubble ai-bubble">
              <text user-select="true">{{item.content}}</text>
            </view>
          </view>
        </view>

        <!-- 用户消息 -->
        <view class="chat-item right" wx:else>
          <view class="bubble my-bubble">
            <text user-select="true">{{item.content}}</text>
          </view>
          <view class="avatar my-avatar">{{myAvatar}}</view>
        </view>
      </block>
      <view id="msg-bottom" style="height: 1px;"></view>
    </scroll-view>

    <!-- 输入区域 -->
    <view class="chat-input-area">
      <textarea
        class="chat-input"
        value="{{chatInput}}"
        bindinput="onChatInput"
        bindconfirm="sendMessage"
        cursor-spacing="20"
        confirm-type="send"
      ></textarea>
      <view class="chat-actions">
        <view class="retro-btn sm-btn" bindtap="goBack">关闭(C)</view>
        <view class="retro-btn sm-btn primary" bindtap="sendMessage">发送(S)</view>
      </view>
    </view>
  </view>
</view>
