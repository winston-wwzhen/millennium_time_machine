<view class="desktop" bindlongpress="onDesktopLongPress">
  <!-- æ¡Œé¢å›¾æ ‡åŒºåŸŸ - è‡ªåŠ¨æ¢åˆ—å¸ƒå±€ -->
  <view class="icon-grid">
    <block wx:for="{{desktopIcons}}" wx:key="id">
      <view class="desktop-icon" bindtap="onIconTap" data-path="{{item.path}}">
        <view class="icon-img">{{item.icon}}</view>
        <text class="icon-label">{{item.name}}</text>
      </view>
    </block>
  </view>

  <!-- æ¡Œé¢åŠ©æ‰‹ï¼šå°ç‹®å­ (Office Assistant é£æ ¼) -->
  <view class="desktop-agent {{isDragging ? 'dragging' : ''}}" style="transform: translate({{agentTranslateX}}px, {{agentTranslateY}}px);"
        catchtouchstart="onAgentDragStart" catchtouchmove="onAgentDragMove" catchtouchend="onAgentDragEnd">
    <view class="agent-bubble {{showMessage ? 'show' : ''}}" wx:if="{{showMessage}}">
      <text>{{agentMessage}}</text>
    </view>
    <view class="agent-body agent-{{agentMood}}">ğŸ¦</view>
  </view>

  <!-- ä»»åŠ¡æ  -->
  <view class="taskbar">
    <view class="start-button {{showStartMenu ? 'active' : ''}}" bindtap="toggleStartMenu">
      <image class="win-logo" src="../../images/borders/border_win98.png" mode="aspectFit"></image>
      <text>Start</text>
    </view>

    <view class="taskbar-divider"></view>

    <view class="task-items">
      <!-- è¿è¡Œä¸­çš„ä»»åŠ¡ -->
    </view>

    <view class="system-tray">
      <view class="tray-icon network-icon {{networkConnected ? 'online' : 'offline'}}" bindtap="onNetworkIconTap">
        {{networkConnected ? 'ğŸŒ' : 'âŒ'}}
      </view>
      <view class="tray-icon">ğŸ”Š</view>
      <view class="system-time">{{systemTime}}</view>
    </view>
  </view>

  <!-- å¼€å§‹èœå•é®ç½© (ç‚¹å‡»å…³é—­) -->
  <view class="start-menu-mask" wx:if="{{showStartMenu}}" catchtap="toggleStartMenu"></view>

  <!-- å¼€å§‹èœå• (å¼¹å‡ºå±‚) -->
  <view class="start-menu" wx:if="{{showStartMenu}}">
    <!-- ç”¨æˆ·æ¨ªå¹… -->
    <view class="user-banner">
      <view class="user-avatar">ğŸ‘¤</view>
      <view class="user-info">
        <text class="user-name">ç®¡ç†å‘˜</text>
        <text class="user-status">åœ¨çº¿</text>
      </view>
    </view>
    <!-- èœå•é¡¹ -->
    <view class="menu-items">
      <view class="menu-item submenu" catchtap="toggleSubmenu">
        <text class="menu-icon">ğŸ“‚</text>
        <text class="menu-text">ç¨‹åº</text>
        <text class="submenu-arrow {{showSubmenu ? 'expanded' : ''}}">{{showSubmenu ? 'â–¾' : 'â–¸'}}</text>
        <!-- ç¨‹åºå­èœå• - å³ä¾§å¼¹å‡º -->
        <view class="submenu-content {{showSubmenu ? 'show' : ''}}" catchtap="stopPropagation">
          <view class="submenu-item" catchtap="onIconTap" data-path="/pages/tetris/index">
            <text class="submenu-icon">ğŸ®</text>
            <text class="submenu-text">ä¿„ç½—æ–¯æ–¹å—</text>
          </view>
          <view class="submenu-item" catchtap="onIconTap" data-path="/pages/star-explorer/index">
            <text class="submenu-icon">ğŸŒŒ</text>
            <text class="submenu-text">æ˜Ÿé™…æ¢ç´¢</text>
          </view>
          <view class="submenu-item" catchtap="onIconTap" data-path="/pages/mars/index">
            <text class="submenu-icon">ğŸª</text>
            <text class="submenu-text">ç«æ˜Ÿç¿»è¯‘</text>
          </view>
        </view>
      </view>
      <view class="menu-item" bindtap="onIconTap" data-path="/pages/my-documents/index">
        <text class="menu-icon">ğŸ“„</text>
        <text class="menu-text">æˆ‘çš„æ–‡æ¡£</text>
      </view>
      <view class="menu-item" bindtap="onIconTap" data-path="/pages/my-computer/index">
        <text class="menu-icon">ğŸ’»</text>
        <text class="menu-text">æˆ‘çš„ç”µè„‘</text>
      </view>
      <view class="menu-item">
        <text class="menu-icon">âš™ï¸</text>
        <text class="menu-text">è®¾ç½®</text>
      </view>
      <view class="menu-item" bindtap="onIconTap" data-path="/pages/about/index">
        <text class="menu-icon">â“</text>
        <text class="menu-text">å¸®åŠ©</text>
      </view>
      <view class="menu-line"></view>
      <view class="menu-item shutdown-item">
        <text class="menu-icon">ğŸ”Œ</text>
        <text class="menu-text">å…³æœº...</text>
      </view>
    </view>
  </view>

  <!-- å³é”®èœå• (å¼¹å‡ºå±‚) -->
  <view class="context-menu" wx:if="{{showContextMenu}}" style="left: {{contextMenuX}}px; top: {{contextMenuY}}px;" catchtap="hideContextMenu">
    <view class="context-menu-item" bindtap="refreshDesktop">
      <text class="context-icon">ğŸ”„</text> åˆ·æ–°(E)
    </view>
    <view class="menu-line"></view>
    <view class="context-menu-item" bindtap="arrangeIcons">
      <text class="context-icon">ğŸ“‹</text> æ’åˆ—å›¾æ ‡(A)
    </view>
    <view class="context-menu-item" bindtap="newFolder">
      <text class="context-icon">ğŸ“</text> æ–°å»º(W)
    </view>
    <view class="menu-line"></view>
    <view class="context-menu-item" bindtap="showProperties">
      <text class="context-icon">â„¹ï¸</text> å±æ€§(R)
    </view>
  </view>
</view>