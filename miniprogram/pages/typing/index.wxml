<view class="typing-container">
  <view class="win98-window">
    <view class="win98-title-bar">
      <view class="win98-title-text">æ‰“å­—ç»ƒä¹  2000</view>
      <view class="win98-title-controls">
        <button class="win98-btn-close" bindtap="goBack"></button>
      </view>
    </view>

    <view class="win98-window-body game-body">
      <!-- ç»Ÿè®¡æ  -->
      <view class="stats-bar">
        <view class="stat-item">
          <text class="stat-label">æ—¶é—´</text>
          <text class="stat-value">{{timeElapsed}}s</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">é€Ÿåº¦</text>
          <text class="stat-value">{{wpm}} WPM</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">å‡†ç¡®ç‡</text>
          <text class="stat-value">{{accuracy}}%</text>
        </view>
      </view>

      <!-- æœ€ä½³è®°å½• -->
      <view class="best-records">
        <text class="record-text">æœ€ä½³: {{bestWpm}} WPM / {{bestAccuracy}}% å‡†ç¡®</text>
      </view>

      <!-- æ–‡å­—æ˜¾ç¤ºåŒº -->
      <view class="text-display">
        <view class="passage-title">{{currentPassage.title}}</view>
        <view class="text-content">
          <block wx:for="{{currentPassage.text}}" wx:key="index">
            <text class="char {{index < charIndex ? (userInput[index] === currentPassage.text[index] ? 'correct' : 'wrong') : ''}} {{index === charIndex ? 'current' : ''}}">
              {{item}}
            </text>
          </block>
        </view>
      </view>

      <!-- è¾“å…¥åŒº -->
      <view class="input-area">
        <textarea
          class="typing-input"
          value="{{userInput}}"
          bindinput="onInputChange"
          placeholder="ç‚¹å‡»è¿™é‡Œå¼€å§‹æ‰“å­—..."
          disabled="{{gameState === 'finished'}}"
          auto-focus
          maxlength="{{currentPassage.text.length}}"
        ></textarea>
      </view>

      <!-- æ§åˆ¶æŒ‰é’® -->
      <view class="control-buttons">
        <button class="win98-btn-std" bindtap="prevPassage">ä¸Šä¸€æ®µ</button>
        <button class="win98-btn-std" bindtap="restartCurrent">é‡æ–°å¼€å§‹</button>
        <button class="win98-btn-std" bindtap="nextPassage">ä¸‹ä¸€æ®µ</button>
      </view>

      <!-- å®Œæˆæç¤º -->
      <view class="finish-overlay" wx:if="{{gameState === 'finished'}}">
        <view class="finish-dialog">
          <view class="finish-header">ç»ƒä¹ å®Œæˆ!</view>
          <view class="finish-stats">
            <text class="finish-stat">é€Ÿåº¦: {{wpm}} WPM</text>
            <text class="finish-stat">å‡†ç¡®ç‡: {{accuracy}}%</text>
            <text class="finish-stat">ç”¨æ—¶: {{timeElapsed}} ç§’</text>
          </view>
          <view class="finish-message">
            <block wx:if="{{wpm >= 80}}">æ‰“å­—å¤§ç¥ï¼âš¡</block>
            <block wx:elif="{{wpm >= 50}}">é€Ÿåº¦ä¸é”™ï¼ğŸ‘</block>
            <block wx:elif="{{wpm >= 30}}">ç»§ç»­åŠ æ²¹ï¼ğŸ’ª</block>
            <block wx:else>å†æ¥å†å‰ï¼ğŸŒ±</block>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
