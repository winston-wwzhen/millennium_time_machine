<view class="win98-desktop">

<view class="window-container game-window">
  
  <view class="menu-overlay" wx:if="{{showGameMenu}}" catchtap="closeMenu"></view>

  <view class="title-bar">
    <view class="title-text">{{headerTitle}}</view>
    <view class="title-controls">
      <view class="control-box">_</view>
      <view class="control-box" bindtap="exitGame">Ã—</view>
    </view>
  </view>

  <view class="menu-bar">
    <view class="menu-item {{showGameMenu ? 'active' : ''}}" catchtap="toggleGameMenu">
      <text class="menu-text">é€‰ æ‹©(S)</text>
      
      <view class="dropdown-menu bevel-outset" wx:if="{{showGameMenu}}">
        <view class="menu-option" catchtap="menuRestart">
          <text class="option-text">é‡ æ¥ (F2)</text>
        </view>
        
        <view class="menu-separator"></view>
        
        <view class="menu-option" catchtap="changeDifficulty" data-level="beginner">
          <text class="check-mark">{{currentDifficulty === 'beginner' ? 'âˆš' : ''}}</text>
          <text class="option-text">â˜…å¾®ç¬‘ç€æµæ³ªâ˜…</text>
        </view>
        
        <view class="menu-option" catchtap="changeDifficulty" data-level="intermediate">
          <text class="check-mark">{{currentDifficulty === 'intermediate' ? 'âˆš' : ''}}</text>
          <text class="option-text">â—†å¯‚å¯åœ¨å”±æ­Œâ—†</text>
        </view>
        
        <view class="menu-option" catchtap="changeDifficulty" data-level="expert">
          <text class="check-mark">{{currentDifficulty === 'expert' ? 'âˆš' : ''}}</text>
          <text class="option-text">â˜£è¢«ä¼¤è¿‡çš„å¿ƒâ˜£</text>
        </view>

        <view class="menu-separator"></view>
        
        <view class="menu-option" catchtap="exitGame">
          <text class="option-text">ç¦» å¼€(X)</text>
        </view>
      </view>
    </view>

    <view class="menu-item" bindtap="closeMenu">
      <text class="menu-text">å¸® åŠ©(H)</text>
    </view>
  </view>

  <view class="window-body game-body">
    <view class="status-panel bevel-inset">
      <view class="led-wrapper">
         <text class="led-label">å¿ƒç¢</text>
         <view class="led-counter">{{beaconsLeft < 10 ? '00' + beaconsLeft : (beaconsLeft < 100 ? '0' + beaconsLeft : beaconsLeft)}}</view>
      </view>
      
      <view class="face-btn bevel-outset" bindtap="resetGame">
        {{gameState === 'lost' ? '(T^T)' : (gameState === 'won' ? '(>â€¿â— )' : '(Â¬_Â¬)')}}
      </view>
      
      <view class="led-wrapper">
         <text class="led-label">æ—¶é—´</text>
         <view class="led-counter">{{timeElapsed < 10 ? '00' + timeElapsed : (timeElapsed < 100 ? '0' + timeElapsed : (timeElapsed > 999 ? 999 : timeElapsed))}}</view>
      </view>
    </view>

    <scroll-view scroll-x scroll-y enable-flex class="board-scroll-container bevel-inset">
      <view class="game-board" 
            style="grid-template-columns: repeat({{difficulty[currentDifficulty].cols}}, {{cellSize}}px); width: {{difficulty[currentDifficulty].cols * cellSize}}px;">
        
        <view class="cell {{item.revealed ? 'revealed' : 'unrevealed'}}"
              wx:for="{{grid}}"
              wx:key="index"
              data-row="{{item.row}}"
              data-col="{{item.col}}"
              bindtap="handleTap"
              bindlongpress="handleLongPress"
              style="width: {{cellSize}}px; height: {{cellSize}}px; line-height: {{cellSize}}px;">
          
          <block wx:if="{{!item.revealed}}">
            <text wx:if="{{item.marked}}" class="icon icon-flag">ğŸš¬</text>
          </block>
          <block wx:else>
            <text wx:if="{{item.isBlackHole}}" class="icon icon-mine">ğŸ’”</text>
            <text wx:elif="{{item.count > 0}}" class="number number-{{item.count}}">{{item.count}}</text>
          </block>

        </view>
      </view>
    </scroll-view>

    <view class="emo-footer">
      <text class="emo-text">{{randomQuote}}</text>
    </view>
    
  </view>
</view>
</view>