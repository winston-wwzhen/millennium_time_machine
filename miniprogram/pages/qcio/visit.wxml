<!-- è®¿é—®ä»–äººç©ºé—´é¡µé¢ -->
<view class="visit-container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="visit-header">
    <view class="visitor-info">
      <text class="visitor-avatar">{{myAvatar || 'ğŸ‘¤'}}</text>
      <text class="visitor-text">è®¿é—®</text>
    </view>
    <view class="owner-info">
      <text class="owner-avatar">{{ownerProfile.avatar || 'ğŸ‘¤'}}</text>
      <text class="owner-nickname">{{ownerProfile.nickname || 'åŠ è½½ä¸­...'}}</text>
      <text class="owner-qcio">({{ownerProfile.qcio_id || ''}})</text>
    </view>
  </view>

  <!-- æœªç™»å½•æç¤º -->
  <view class="login-tip" wx:if="{{!isLoggedIn}}">
    <text class="tip-icon">ğŸ’¡</text>
    <text class="tip-text">ç™»å½•åæ‰èƒ½è¸©ä¸€è„šå“¦~</text>
    <button class="win98-btn-primary login-btn" bindtap="goToLogin">å»ç™»å½•</button>
  </view>

  <!-- è®¿é—®è‡ªå·±çš„ç©ºé—´æç¤º -->
  <view class="self-visit-tip" wx:if="{{isOwnSpace}}">
    <text class="tip-icon">ğŸ </text>
    <text class="tip-text">è¿™æ˜¯ä½ çš„ç©ºé—´</text>
    <button class="win98-btn-primary login-btn" bindtap="goToMySpace">è¿›å…¥æˆ‘çš„ç©ºé—´</button>
  </view>

  <!-- è¸©ä¸€è¸©ç»Ÿè®¡ -->
  <view class="section-title">ğŸ‘£ è¸©ä¸€è¸©ç»Ÿè®¡</view>
  <view class="visit-stats">
    <view class="stat-row">
      <view class="stat-item">
        <text class="stat-number">{{visitStats.totalVisits || 0}}</text>
        <text class="stat-label">å†å²è®¿é—®</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-number">{{visitStats.todayVisits || 0}}</text>
        <text class="stat-label">ä»Šæ—¥è®¿é—®</text>
      </view>
    </view>
  </view>

  <!-- è¸©ä¸€è„šæŒ‰é’® -->
  <button
    class="win98-btn-primary step-btn {{hasSteppedToday ? 'stepped' : ''}}"
    bindtap="doStep"
    disabled="{{hasSteppedToday || !isLoggedIn || isOwnSpace}}"
  >
    {{hasSteppedToday ? 'âœ“ ä»Šå¤©å·²ç»è¸©è¿‡äº†' : 'ğŸ‘£ è¸©ä¸€è„š'}}
  </button>

  <!-- ç•™è¨€æ¿ -->
  <view class="section-title">ğŸ“ ç•™è¨€æ¿</view>
  <view class="guestbook-container">
    <view class="guestbook-list" wx:if="{{messages.length > 0}}">
      <view class="guestbook-item" wx:for="{{messages}}" wx:key="id">
        <view class="guestbook-avatar">{{item.avatar}}</view>
        <view class="guestbook-content">
          <view class="guestbook-header">
            <text class="guestbook-name">{{item.nickname}}</text>
            <text class="guestbook-time">{{item.time}}</text>
          </view>
          <view class="guestbook-text">{{item.content}}</view>
        </view>
      </view>
    </view>
    <view class="empty-state" wx:else>
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰ç•™è¨€ï¼Œå¿«æ¥è¸©ä¸€è„šå§~</text>
    </view>
  </view>

  <!-- æœ€è¿‘è®¿å®¢ -->
  <view class="section-title" wx:if="{{recentVisitors.length > 0}}">ğŸ‘¥ æœ€è¿‘æ¥è®¿</view>
  <view class="recent-visitors" wx:if="{{recentVisitors.length > 0}}">
    <view class="visitor-avatar-item" wx:for="{{recentVisitors}}" wx:key="_id">
      <text class="visitor-avatar-small">{{item.avatar || 'ğŸ‘¤'}}</text>
      <text class="visitor-name-small">{{item.nickname}}</text>
    </view>
  </view>

  <!-- è¿”å›æŒ‰é’® -->
  <view class="footer-actions">
    <button class="win98-btn-secondary back-btn" bindtap="goBack">
      â† è¿”å›æˆ‘çš„ç©ºé—´
    </button>
  </view>
</view>
