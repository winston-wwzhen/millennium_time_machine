<!-- å†œåœºé¡µé¢ - Win98 é£æ ¼ -->
<view class="farm-container">
  <!-- Win98 çª—å£ -->
  <view class="win98-window">
    <!-- æ ‡é¢˜æ  -->
    <view class="win98-title-bar">
      <view class="win98-title-text">ğŸŒ¾ æˆ‘çš„å†œåœº</view>
      <view class="win98-title-controls">
        <button class="win98-btn-close" bindtap="goBack">Ã—</button>
      </view>
    </view>

    <!-- çª—å£å†…å®¹ -->
    <view class="win98-content">
      <!-- å†œåœºä¿¡æ¯æ  -->
      <view class="farm-info-bar">
        <view class="info-item">
          <text class="info-label">ç­‰çº§:</text>
          <text class="info-value">Lv.{{farmProfile ? farmProfile.farmLevel : 1}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">ç»éªŒ:</text>
          <text class="info-value">{{farmProfile ? farmProfile.farmExp : 0}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">é‡‘å¸:</text>
          <text class="info-value gold">ğŸ’° {{coins}}</text>
        </view>
      </view>

      <!-- å†œåœºåœŸåœ°ç½‘æ ¼ -->
      <view class="farm-grid">
        <block wx:for="{{plots}}" wx:key="index">
          <view
            class="farm-plot {{item.status}}"
            bindtap="onPlotTap"
            data-index="{{index}}"
            wx:if="{{index < unlockedPlots}}"
          >
            <!-- ç©ºåœ° -->
            <view wx:if="{{item.status === 'empty'}}" class="plot-empty">
              <text class="plot-icon">ğŸŸ«</text>
              <text class="plot-hint">ç‚¹å‡»ç§æ¤</text>
            </view>

            <!-- ç”Ÿé•¿ä¸­ -->
            <view wx:if="{{item.status === 'growing'}}" class="plot-growing">
              <text class="plot-icon">{{item.cropType === 'mood' ? 'ğŸ’­' : 'ğŸŒ±'}}</text>
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{item.progress}}%"></view>
              </view>
              <text class="time-left">{{item.progress}}%</text>
            </view>

            <!-- æˆç†Ÿ -->
            <view wx:if="{{item.status === 'mature'}}" class="plot-mature">
              <text class="plot-icon mature-anim">âœ¨</text>
              <text class="harvest-hint">ç‚¹å‡»æ”¶è·</text>
            </view>
          </view>

          <!-- æœªè§£é”åœŸåœ° -->
          <view wx:elif="{{index < 24}}" class="farm-plot locked">
            <text class="plot-icon">ğŸ”’</text>
            <text class="lock-hint">æœªè§£é”</text>
          </view>
        </block>
      </view>

      <!-- æ“ä½œæŒ‰é’®æ  -->
      <view class="action-bar">
        <button class="win98-btn-std" bindtap="openShop">ğŸª å•†åº—</button>
        <button class="win98-btn-std" bindtap="refreshData">ğŸ”„ åˆ·æ–°</button>
        <button class="win98-btn-std" bindtap="goBack">ğŸ”™ è¿”å›</button>
      </view>
    </view>
  </view>

  <!-- å•†åº—å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showShopModal}}" bindtap="closeShop">
    <view class="modal-content" catchtap="">
      <view class="win98-window shop-window">
        <view class="win98-title-bar">
          <text class="win98-title-text">ğŸª å†œåœºå•†åº—</text>
          <button class="win98-btn-close" bindtap="closeShop">Ã—</button>
        </view>

        <view class="win98-content shop-content">
          <!-- Tab åˆ‡æ¢ -->
          <view class="shop-tabs">
            <view
              class="shop-tab {{shopActiveTab === 'seeds' ? 'active' : ''}}"
              bindtap="switchShopTab"
              data-tab="seeds"
            >
              ğŸŒ± ç§å­
            </view>
            <view
              class="shop-tab {{shopActiveTab === 'decorations' ? 'active' : ''}}"
              bindtap="switchShopTab"
              data-tab="decorations"
            >
              ğŸ¨ è£…é¥°
            </view>
          </view>

          <!-- ç§å­åˆ—è¡¨ -->
          <scroll-view class="shop-list" scroll-y wx:if="{{shopActiveTab === 'seeds'}}">
            <!-- ä¼ ç»Ÿä½œç‰© -->
            <view class="shop-section-title">ğŸŒ¾ ä¼ ç»Ÿä½œç‰©</view>
            <view class="shop-item" wx:for="{{traditionalCrops}}" wx:key="id" bindtap="buySeed" data-crop-type="traditional" data-crop-id="{{item.id}}">
              <text class="item-icon">{{item.icon}}</text>
              <view class="item-info">
                <text class="item-name">{{item.name}}</text>
                <text class="item-desc">{{item.durationText}}æˆç†Ÿ</text>
              </view>
              <view class="item-price">
                <text class="price-icon">ğŸ’°</text>
                <text>{{item.cost}}</text>
              </view>
            </view>

            <!-- å¿ƒæƒ…ä½œç‰© -->
            <view class="shop-section-title">ğŸ’­ å¿ƒæƒ…ä½œç‰©</view>
            <view class="shop-item" wx:for="{{moodCrops}}" wx:key="id" bindtap="buySeed" data-crop-type="mood" data-crop-id="{{item.id}}">
              <text class="item-icon">{{item.icon}}</text>
              <view class="item-info">
                <text class="item-name">{{item.name}}</text>
                <text class="item-desc">{{item.durationText}}æˆç†Ÿ</text>
              </view>
              <view class="item-price">
                <text class="price-icon">ğŸ’°</text>
                <text>{{item.cost}}</text>
              </view>
            </view>
          </scroll-view>

          <!-- è£…é¥°åˆ—è¡¨ -->
          <scroll-view class="shop-list" scroll-y wx:if="{{shopActiveTab === 'decorations'}}">
            <view class="shop-item" wx:for="{{decorations}}" wx:key="id" bindtap="buyDecoration" data-id="{{item.id}}">
              <text class="item-icon">{{item.icon}}</text>
              <view class="item-info">
                <text class="item-name">{{item.name}}</text>
                <text class="item-desc">{{item.effect}}</text>
              </view>
              <view class="item-price">
                <text class="price-icon">ğŸ’°</text>
                <text>{{item.cost}}</text>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>
    </view>
  </view>
</view>
