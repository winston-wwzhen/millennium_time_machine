<!-- 我的电脑 - Win98 风格窗口组件 -->
<view class="my-computer-overlay {{show ? 'show' : 'hide'}}" style="{{overlayStyle}}" catchtap="onClose">
  <view class="win98-window" catchtap="stopPropagation" catchlongpress="stopPropagation" catchtouchmove="stopPropagation">
    <view class="win98-title-bar">
      <view class="win98-title-text">我的电脑</view>
      <view class="win98-title-controls">
        <button class="win98-btn-close" bindtap="onClose">×</button>
      </view>
    </view>

    <!-- 菜单栏 -->
    <view class="menu-bar" bindtap="onMenuBarTap">
      <!-- 文件菜单 -->
      <view class="menu-dropdown-wrapper">
        <view class="menu-dropdown-trigger" catchtap="onFileMenuTap">
          <text class="menu-item">文件</text>
        </view>
        <!-- 文件菜单下拉 -->
        <view class="menu-dropdown-content" wx:if="{{showFileMenu}}" catchtap="stopPropagation">
          <view class="menu-dropdown-item" catchtap="onShowSystemProperties">
            <text class="menu-item-icon">🖥️</text>
            <text>系统属性</text>
          </view>
          <view class="menu-dropdown-item" catchtap="onShowDiskCleanup">
            <text class="menu-item-icon">💿</text>
            <text>磁盘清理</text>
          </view>
          <view class="menu-dropdown-item" catchtap="onShowDeviceManager">
            <text class="menu-item-icon">🔧</text>
            <text>设备管理器</text>
          </view>
          <view class="menu-dropdown-separator"></view>
          <view class="menu-dropdown-item" catchtap="onCloseWindow">
            <text class="menu-item-icon">❌</text>
            <text>关闭</text>
          </view>
        </view>
      </view>
      <!-- 编辑菜单 -->
      <view class="menu-dropdown-wrapper">
        <view class="menu-dropdown-trigger" catchtap="onEditMenuTap">
          <text class="menu-item">编辑</text>
        </view>
        <!-- 编辑菜单下拉 -->
        <view class="menu-dropdown-content" wx:if="{{showEditMenu}}" catchtap="stopPropagation">
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">↩️</text>
            <text>撤销</text>
          </view>
          <view class="menu-dropdown-separator"></view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">✂️</text>
            <text>剪切</text>
          </view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📋</text>
            <text>复制</text>
          </view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📄</text>
            <text>粘贴</text>
          </view>
          <view class="menu-dropdown-separator"></view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">🔍</text>
            <text>全部选中</text>
          </view>
        </view>
      </view>
      <!-- 查看菜单 -->
      <view class="menu-dropdown-wrapper">
        <view class="menu-dropdown-trigger" catchtap="onViewMenuTap">
          <text class="menu-item">查看</text>
        </view>
        <!-- 查看菜单下拉 -->
        <view class="menu-dropdown-content" wx:if="{{showViewMenu}}" catchtap="stopPropagation">
          <view class="menu-dropdown-item" catchtap="onRefreshView">
            <text class="menu-item-icon">🔄</text>
            <text>刷新</text>
          </view>
          <view class="menu-dropdown-separator"></view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📊</text>
            <text>大图标</text>
          </view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📋</text>
            <text>小图标</text>
          </view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📝</text>
            <text>列表</text>
          </view>
          <view class="menu-dropdown-item menu-disabled">
            <text class="menu-item-icon">📄</text>
            <text>详细信息</text>
          </view>
        </view>
      </view>
      <!-- 帮助菜单 -->
      <view class="menu-dropdown-wrapper">
        <view class="menu-dropdown-trigger" catchtap="onHelpMenuTap">
          <text class="menu-item">帮助</text>
        </view>
        <!-- 帮助菜单下拉 -->
        <view class="menu-dropdown-content" wx:if="{{showHelpMenu}}" catchtap="stopPropagation">
          <view class="menu-dropdown-item" catchtap="onShowHelp">
            <text class="menu-item-icon">❓</text>
            <text>帮助主题</text>
          </view>
          <view class="menu-dropdown-item" catchtap="onShowAbout">
            <text class="menu-item-icon">ℹ️</text>
            <text>关于</text>
          </view>
        </view>
      </view>
    </view>

    <view class="win98-window-body" bindtap="onWindowBodyTap">
      <!-- 驱动器列表 -->
      <view class="drives-grid {{isRefreshing ? 'refreshing' : ''}}">
        <!-- C盘 - 独占第一行 -->
        <view class="drive-item drive-c">
          <view class="drive-icon" bindtap="onDriveTap" data-drive="C">💾</view>
          <view class="drive-info">
            <text class="drive-label">(C:)</text>
            <text class="drive-size">本地磁盘</text>
            <view class="capacity-bar">
              <view class="capacity-used" style="width: {{diskUsagePercent}}%"></view>
            </view>
            <text class="capacity-text {{diskUsagePercent >= 90 ? 'capacity-warning' : ''}}">{{diskUsageText}}</text>
          </view>
        </view>

        <!-- 分割线 -->
        <view class="drive-divider"></view>

        <!-- 第二行驱动器容器 -->
        <view class="drives-row-secondary">
          <view class="drive-item">
            <view class="drive-icon" bindtap="onDriveTap" data-drive="D">💾</view>
            <text class="drive-label">(D:)</text>
            <text class="drive-size">本地磁盘</text>
          </view>
          <view class="drive-item">
            <view class="drive-icon" bindtap="onDriveTap" data-drive="USB">📱</view>
            <text class="drive-label">可移动</text>
            <text class="drive-size">USB设备</text>
          </view>
        </view>
      </view>

      <!-- 系统信息区域 -->
      <view class="system-info-panel">
        <view class="system-info-row">
          <text class="system-info-label">处理器：</text>
          <text class="system-info-value">Intel Pentium III 800MHz</text>
        </view>
        <view class="system-info-row">
          <text class="system-info-label">内存：</text>
          <text class="system-info-value">128 MB RAM</text>
        </view>
        <view class="system-info-row">
          <text class="system-info-label">系统：</text>
          <text class="system-info-value">Microsoft Windows 98 第二版</text>
        </view>
        <view class="system-info-row" wx:if="{{userInfo}}">
          <text class="system-info-label">用户：</text>
          <text class="system-info-value">{{userInfo.avatarName}}</text>
        </view>
      </view>
    </view>

    <!-- 状态栏 -->
    <view class="status-bar">
      <text>3 个对象</text>
    </view>
  </view>

  <!-- 驱动器弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDriveDialog}}" catchtap="closeDriveDialog">
    <view class="win98-window drive-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">{{driveDialogData.title}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeDriveDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="drive-dialog-content">
          <view class="drive-dialog-icon">{{driveDialogData.icon}}</view>
          <text class="drive-dialog-message">{{driveDialogData.message}}</text>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeDriveDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 帮助弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showHelpDialog}}" catchtap="onCloseHelpDialog">
    <view class="win98-window help-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">💡 我的电脑 - 帮助</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseHelpDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <scroll-view class="help-content" scroll-y>
          <text class="help-title">我的电脑</text>
          <text class="help-text">浏览虚拟驱动器和系统信息。</text>

          <view class="help-section">
            <text class="help-section-title">💾 驱动器说明</text>
            <view class="help-features">
              <text class="help-feature">• 点击驱动器打开文件浏览器</text>
              <text class="help-feature">• C盘：系统文件夹和程序</text>
              <text class="help-feature">• D盘：下载、软件、游戏、资料</text>
              <text class="help-feature">• USB：可移动存储设备</text>
            </view>
          </view>

          <view class="help-section">
            <text class="help-section-title">⚙️ 系统功能</text>
            <view class="help-features">
              <text class="help-feature">• 系统属性：查看硬件和账号信息</text>
              <text class="help-feature">• 磁盘清理：每日清理获得时光币</text>
              <text class="help-feature">• 设备管理器：查看虚拟硬件设备</text>
            </view>
          </view>

          <view class="help-section">
            <text class="help-section-title">🎮 彩蛋提示</text>
            <view class="help-features">
              <text class="help-feature">• 文件夹中藏有秘密彩蛋文件</text>
              <text class="help-feature">• 探索所有文件夹发现彩蛋</text>
              <text class="help-feature">• 在设备管理器查看所有设备</text>
            </view>
          </view>
        </scroll-view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onCloseHelpDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 关于弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showAboutDialog}}" catchtap="closeAboutDialog">
    <view class="win98-window about-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">ℹ️ 关于 千禧时光机</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeAboutDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="about-content">
          <!-- Logo 区域 -->
          <view class="about-logo">
            <text class="about-logo-icon">💾</text>
            <text class="about-logo-title">千禧时光机</text>
            <text class="about-logo-version">v3.7.0</text>
          </view>

          <!-- 描述信息 -->
          <view class="about-description">
            <text class="about-text">一款致敬2006年的怀旧小程序</text>
            <text class="about-text">带你穿越回那个纯真的年代</text>
          </view>

          <!-- 分隔线 -->
          <view class="about-divider"></view>

          <!-- 版权信息 -->
          <view class="about-copyright">
            <text class="about-copyright-text">© 2006 千禧科技</text>
            <text class="about-copyright-text">保留所有权利</text>
          </view>

          <!-- 系统信息 -->
          <view class="about-system-info">
            <text class="about-system-text">系统：Microsoft Windows 98 第二版</text>
            <text class="about-system-text">内存：128 MB RAM</text>
            <text class="about-system-text">处理器：Pentium III 800MHz</text>
          </view>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeAboutDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 系统属性弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showSystemProperties}}" catchtap="onCloseSystemProperties">
    <view class="win98-window system-properties-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">🖥️ 系统属性</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseSystemProperties">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <scroll-view class="system-properties-content" scroll-y>
          <!-- 系统信息区域 -->
          <view class="sp-section">
            <view class="sp-header">Microsoft Windows 98 第二版</view>
            <view class="sp-info">
              <text class="sp-label">注册给：</text>
              <text class="sp-value">千禧网友</text>
            </view>
            <view class="sp-info">
              <text class="sp-label">计算机：</text>
              <text class="sp-value">Pentium(R) III CPU 800 MHz / 128 MB RAM</text>
            </view>
          </view>

          <!-- 硬件信息 -->
          <view class="sp-section">
            <view class="sp-section-title">💻 硬件信息</view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">处理器：</text>
              <text class="sp-info-value">{{systemInfo.cpu}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">内存：</text>
              <text class="sp-info-value">{{systemInfo.memory}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">硬盘：</text>
              <text class="sp-info-value">{{systemInfo.hardDrive}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">显卡：</text>
              <text class="sp-info-value">{{systemInfo.graphics}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">声卡：</text>
              <text class="sp-info-value">{{systemInfo.sound}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{systemInfo}}">
              <text class="sp-info-label">网卡：</text>
              <text class="sp-info-value">{{systemInfo.network}}</text>
            </view>
          </view>

          <!-- 千禧时光机账号信息 -->
          <view class="sp-section">
            <view class="sp-section-title">🎮 千禧时光机账号信息</view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">QCIO 账号：</text>
              <text class="sp-info-value">{{userInfo.qcioAccount || '未注册'}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">等级：</text>
              <text class="sp-info-value">LV.{{userInfo.level}} {{userInfo.starsDisplay || ''}}</text>
            </view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">Q点：</text>
              <text class="sp-info-value">{{userInfo.qpoints}} Q点</text>
            </view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">网费：</text>
              <text class="sp-info-value">{{userInfo.netFeeDays}} 天</text>
            </view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">时光币：</text>
              <text class="sp-info-value">{{userInfo.coins}} 💎</text>
            </view>
            <view class="sp-info-row" wx:if="{{userInfo}}">
              <text class="sp-info-label">彩蛋发现：</text>
              <text class="sp-info-value">{{userInfo.eggProgress}}</text>
            </view>
          </view>
        </scroll-view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onCloseSystemProperties">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 磁盘清理确认弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDiskCleanupConfirm}}" catchtap="closeDiskCleanupDialogs">
    <view class="win98-window disk-cleanup-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">💿 磁盘清理</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeDiskCleanupDialogs">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="disk-cleanup-content">
          <view class="disk-cleanup-icon">💿</view>
          <text class="disk-cleanup-message">即将扫描磁盘，清理临时文件释放空间...</text>
          <text class="disk-cleanup-today">今天已清理：{{diskCleanupTodayCount}}/1 次</text>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeDiskCleanupDialogs">取消</button>
          <button class="win98-btn-std" bindtap="onStartDiskCleanup">开始扫描</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 磁盘清理扫描弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDiskCleanupScanning}}" catchtap="closeDiskCleanupDialogs">
    <view class="win98-window disk-cleanup-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">正在扫描磁盘...</view>
      </view>
      <view class="win98-window-body">
        <view class="disk-cleanup-content">
          <text class="disk-cleanup-status">正在扫描 {{fileExplorerCurrentDrive || 'C'}}盘...</text>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{diskCleanupProgress}}%"></view>
          </view>
          <text class="disk-cleanup-progress-text">{{diskCleanupProgress}}%</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 磁盘清理结果弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDiskCleanupResult}}" catchtap="closeDiskCleanupDialogs">
    <view class="win98-window disk-cleanup-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">{{diskCleanupResult && diskCleanupResult.success ? '磁盘清理完成' : '磁盘清理'}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeDiskCleanupDialogs">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="disk-cleanup-content" wx:if="{{diskCleanupResult && diskCleanupResult.success}}">
          <!-- 有奖励：显示详细清理内容 -->
          <view wx:if="{{diskCleanupResult.hasReward}}">
            <text class="disk-cleanup-result-title">清理内容：</text>
            <view class="cleanup-item">
              <text class="cleanup-icon">💾</text>
              <text class="cleanup-name">临时文件</text>
              <text class="cleanup-size">{{diskCleanupResult.tempFiles}}MB</text>
            </view>
            <view class="cleanup-item">
              <text class="cleanup-icon">🗑️</text>
              <text class="cleanup-name">缓存文件</text>
              <text class="cleanup-size">{{diskCleanupResult.cacheFiles}}MB</text>
            </view>
            <view class="cleanup-item">
              <text class="cleanup-icon">📄</text>
              <text class="cleanup-name">旧日志</text>
              <text class="cleanup-size">{{diskCleanupResult.oldLogs}}MB</text>
            </view>
            <view class="cleanup-divider"></view>
            <view class="cleanup-total">
              <text class="cleanup-total-label">总计：</text>
              <text class="cleanup-total-size">{{diskCleanupResult.tempFiles + diskCleanupResult.cacheFiles + diskCleanupResult.oldLogs}}MB</text>
            </view>
            <view class="cleanup-reward" wx:if="{{diskCleanupResult.diskUsageBefore !== undefined}}">
              <text class="cleanup-reward-text">磁盘容量：</text>
              <text class="cleanup-reward-amount">{{diskCleanupResult.diskUsageBefore}}% → {{diskCleanupResult.diskUsageAfter}}%</text>
            </view>
            <view class="cleanup-reward">
              <text class="cleanup-reward-text">获得奖励：</text>
              <text class="cleanup-reward-amount">💎 +{{diskCleanupResult.tempFiles + diskCleanupResult.cacheFiles + diskCleanupResult.oldLogs}} 时光币</text>
            </view>
          </view>
          <!-- 无奖励：显示提示信息 -->
          <view wx:else class="disk-cleanup-no-reward">
            <text class="disk-cleanup-icon">✅</text>
            <text class="disk-cleanup-message">{{diskCleanupResult.message || '磁盘清理完成'}}</text>
            <text class="disk-cleanup-hint">每天只有第一次清理获得奖励</text>
          </view>
        </view>
        <view class="disk-cleanup-content" wx:else>
          <text class="disk-cleanup-error">{{diskCleanupResult ? diskCleanupResult.message : '清理失败'}}</text>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeDiskCleanupDialogs">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 设备管理器弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDeviceManager}}" catchtap="onCloseDeviceManager">
    <view class="win98-window device-manager-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">🔧 设备管理器</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseDeviceManager">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <scroll-view class="device-manager-content" scroll-y>
          <view class="sp-section">
            <view class="sp-header">💻 千禧时光机电脑</view>
            <view class="device-list">
              <view class="device-item" wx:for="{{devices}}" wx:key="id" bindtap="onShowDeviceDetail" data-device-id="{{item.id}}">
                <text class="device-icon">{{item.icon}}</text>
                <text class="device-name">{{item.name}}</text>
              </view>
            </view>
          </view>
        </scroll-view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onCloseDeviceManager">关闭</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 设备详情弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showDeviceDetail}}" catchtap="onCloseDeviceDetail">
    <view class="win98-window device-detail-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">{{selectedDevice.name}} 属性</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseDeviceDetail">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="device-detail-content">
          <!-- 设备图标和状态 -->
          <view class="device-detail-header">
            <text class="device-detail-icon">{{selectedDevice.icon}}</text>
            <text class="device-detail-status">✅ 运行正常</text>
          </view>

          <!-- 设备信息区域 -->
          <view class="sp-section">
            <view class="sp-section-title">设备信息</view>
            <view class="sp-info-row">
              <text class="sp-info-label">设备名称：</text>
              <text class="sp-info-value">{{selectedDevice.name}}</text>
            </view>
            <view class="sp-info-row">
              <text class="sp-info-label">设备类型：</text>
              <text class="sp-info-value">{{selectedDevice.typeText}}</text>
            </view>
            <view class="sp-info-row">
              <text class="sp-info-label">状态：</text>
              <text class="sp-info-value" style="color: #00aa00;">运行正常</text>
            </view>
          </view>

          <!-- 描述和备注 -->
          <view class="sp-section">
            <view class="sp-section-title">详细信息</view>
            <view class="sp-info-row">
              <text class="sp-info-label">描述：</text>
              <text class="sp-info-value">{{selectedDevice.description}}</text>
            </view>
          </view>

          <!-- 备注区域 -->
          <view class="sp-section" style="background: #ffffcc;">
            <view class="sp-section-title">💬 备注</view>
            <text class="device-detail-remark-text">"{{selectedDevice.remark}}"</text>
          </view>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onCloseDeviceDetail">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 文件浏览器弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showFileExplorer}}" catchtap="onCloseFileExplorer">
    <view class="win98-window file-explorer-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">{{fileExplorerPath}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseFileExplorer">×</button>
        </view>
      </view>

      <!-- 菜单栏 -->
      <view class="menu-bar" bindtap="onFeMenuBarTap">
        <!-- 文件(F) -->
        <view class="menu-dropdown-wrapper">
          <view class="menu-dropdown-trigger" catchtap="toggleFileExplorerMenu" data-menu="File">
            <text class="menu-item menu-small">文件</text>
          </view>
          <view class="menu-dropdown-content" wx:if="{{feShowFileMenu}}" catchtap="stopPropagation">
            <view class="menu-dropdown-item" catchtap="onFeNewFolder">
              <text class="menu-item-icon">📁</text>
              <text>新建文件夹</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeRename">
              <text class="menu-item-icon">✏️</text>
              <text>重命名</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeDelete">
              <text class="menu-item-icon">🗑️</text>
              <text>删除</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeProperties">
              <text class="menu-item-icon">ℹ️</text>
              <text>属性</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeClose">
              <text class="menu-item-icon">✖️</text>
              <text>关闭</text>
            </view>
          </view>
        </view>

        <!-- 编辑(E) -->
        <view class="menu-dropdown-wrapper">
          <view class="menu-dropdown-trigger" catchtap="toggleFileExplorerMenu" data-menu="Edit">
            <text class="menu-item menu-small">编辑</text>
          </view>
          <view class="menu-dropdown-content" wx:if="{{feShowEditMenu}}" catchtap="stopPropagation">
            <view class="menu-dropdown-item" catchtap="onFeUndo">
              <text class="menu-item-icon">↩️</text>
              <text>撤销</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeSelectAll">
              <text class="menu-item-icon">☑️</text>
              <text>全选</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeInvertSelection">
              <text class="menu-item-icon">🔄</text>
              <text>反向选择</text>
            </view>
          </view>
        </view>

        <!-- 查看(V) -->
        <view class="menu-dropdown-wrapper">
          <view class="menu-dropdown-trigger" catchtap="toggleFileExplorerMenu" data-menu="View">
            <text class="menu-item menu-small">查看</text>
          </view>
          <view class="menu-dropdown-content" wx:if="{{feShowViewMenu}}" catchtap="stopPropagation">
            <view class="menu-dropdown-item" catchtap="onFeShowHiddenFiles">
              <text class="menu-item-icon">👁️</text>
              <text>显示所有文件</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeRefresh">
              <text class="menu-item-icon">🔄</text>
              <text>刷新</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeViewMode">
              <text class="menu-item-icon">📋</text>
              <text>大图标</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeViewMode">
              <text class="menu-item-icon">📋</text>
              <text>小图标</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeViewMode">
              <text class="menu-item-icon">📋</text>
              <text>列表</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeViewMode">
              <text class="menu-item-icon">📋</text>
              <text>详细信息</text>
            </view>
          </view>
        </view>

        <!-- 收藏(A) -->
        <view class="menu-dropdown-wrapper">
          <view class="menu-dropdown-trigger" catchtap="toggleFileExplorerMenu" data-menu="Favorites">
            <text class="menu-item menu-small">收藏</text>
          </view>
          <view class="menu-dropdown-content" wx:if="{{feShowFavoritesMenu}}" catchtap="stopPropagation">
            <view class="menu-dropdown-item" catchtap="onFeAddToFavorites">
              <text class="menu-item-icon">➕</text>
              <text>添加到收藏夹</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeOrganizeFavorites">
              <text class="menu-item-icon">📂</text>
              <text>整理收藏夹</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeQuickJump" data-drive="C">
              <text class="menu-item-icon">💾</text>
              <text>C盘</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeQuickJump" data-drive="D">
              <text class="menu-item-icon">💿</text>
              <text>D盘</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeQuickJump" data-drive="USB">
              <text class="menu-item-icon">📱</text>
              <text>USB盘</text>
            </view>
          </view>
        </view>

        <!-- 帮助(H) -->
        <view class="menu-dropdown-wrapper">
          <view class="menu-dropdown-trigger" catchtap="toggleFileExplorerMenu" data-menu="Help">
            <text class="menu-item menu-small">帮助</text>
          </view>
          <view class="menu-dropdown-content" wx:if="{{feShowHelpMenu}}" catchtap="stopPropagation">
            <view class="menu-dropdown-item" catchtap="onFeHelpTopic">
              <text class="menu-item-icon">❓</text>
              <text>帮助主题</text>
            </view>
            <view class="menu-dropdown-item" catchtap="onFeAbout">
              <text class="menu-item-icon">ℹ️</text>
              <text>关于</text>
            </view>
          </view>
        </view>
      </view>

      <view class="win98-window-body" bindtap="onFeWindowBodyTap" catchlongpress="stopPropagation">
        <!-- 工具栏 -->
        <view class="file-explorer-toolbar" catchtap="stopPropagation">
          <view class="toolbar-btn" bindtap="onGoBack" wx:if="{{fileExplorerBreadcrumbs.length > 1}}">
            <text class="toolbar-btn-icon">⬆️</text>
            <text class="toolbar-btn-text">向上</text>
          </view>
          <view class="file-explorer-address">
            <text class="address-label">地址：</text>
            <text class="address-path">{{fileExplorerPath}}</text>
          </view>
        </view>

        <!-- 文件列表 -->
        <scroll-view class="file-explorer-content" scroll-y catchlongpress="stopPropagation">
          <view class="file-list {{feIsRefreshing ? 'refreshing' : ''}}" catchlongpress="stopPropagation">
            <view class="file-item {{item.disabled ? 'disabled' : ''}}" wx:for="{{fileExplorerItems}}" wx:key="name" bindtap="onFileItemTap" catchlongpress="onFileItemLongPressStart" bindtouchend="onFileItemLongPressEnd" data-item="{{item}}">
              <text class="file-icon" wx:if="{{item.icon.length < 20}}">{{item.icon}}</text>
              <image class="file-icon image-folder" src="{{item.icon}}" mode="aspectFit" wx:else></image>
              <text class="file-name">{{item.name}}</text>
              <text class="file-rarity" wx:if="{{item.rarity}}">{{item.rarity === 'common' ? '⭐' : item.rarity === 'rare' ? '💎' : item.rarity === 'epic' ? '🌟' : '👑'}}</text>
            </view>
          </view>
        </scroll-view>
      </view>

      <!-- 状态栏 -->
      <view class="status-bar">
        <text>{{fileExplorerItems.length}} 个对象</text>
      </view>
    </view>
  </view>

  <!-- 文件浏览器帮助弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showFeHelpDialog}}" catchtap="closeFeHelpDialog">
    <view class="win98-window fe-help-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">❓ 文件浏览器 - 帮助</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeFeHelpDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="fe-help-content">
          <view class="fe-help-section">
            <text class="fe-help-title">📁 文件浏览</text>
            <view class="fe-help-items">
              <text class="fe-help-item">• 点击文件夹进入子目录</text>
              <text class="fe-help-item">• 点击文件查看内容（部分文件可查看）</text>
              <text class="fe-help-item">• 使用"向上"按钮返回上一级</text>
            </view>
          </view>

          <view class="fe-help-section">
            <text class="fe-help-title">👁️ 视图选项</text>
            <view class="fe-help-items">
              <text class="fe-help-item">• "显示所有文件"可查看隐藏文件</text>
              <text class="fe-help-item">• "刷新"重新加载当前目录</text>
            </view>
          </view>

          <view class="fe-help-section">
            <text class="fe-help-title">📂 快速导航</text>
            <view class="fe-help-items">
              <text class="fe-help-item">• 收藏菜单可快速跳转到各驱动器</text>
            </view>
          </view>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeFeHelpDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 文件浏览器关于弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showFeAboutDialog}}" catchtap="closeFeAboutDialog">
    <view class="win98-window fe-about-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">ℹ️ 关于</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeFeAboutDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="fe-about-content">
          <!-- Logo 区域 -->
          <view class="fe-about-logo">
            <text class="fe-about-logo-icon">📂</text>
            <text class="fe-about-logo-title">文件浏览器</text>
            <text class="fe-about-logo-version">v1.0</text>
          </view>

          <!-- 描述信息 -->
          <view class="fe-about-description">
            <text class="fe-about-text">千禧时光机组件</text>
          </view>

          <!-- 分隔线 -->
          <view class="fe-about-divider"></view>

          <!-- 版权信息 -->
          <view class="fe-about-copyright">
            <text class="fe-about-copyright-text">© 2006 千禧科技</text>
            <text class="fe-about-copyright-text">保留所有权利</text>
          </view>

          <!-- 彩蛋提示 -->
          <view class="fe-about-egg">
            <text class="fe-about-egg-text">（实际上是2025年笨蛋程序员写的）</text>
          </view>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeFeAboutDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 文件浏览器属性弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showFePropertiesDialog}}" catchtap="closeFePropertiesDialog">
    <view class="win98-window fe-properties-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">📋 属性</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeFePropertiesDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="fe-properties-content">
          <!-- 路径信息 -->
          <view class="fe-properties-section">
            <text class="fe-properties-label">位置：</text>
            <text class="fe-properties-value">{{fePropertiesData.path}}</text>
          </view>

          <!-- 统计信息 -->
          <view class="fe-properties-stats">
            <view class="fe-stat-item">
              <text class="fe-stat-icon">📁</text>
              <view class="fe-stat-info">
                <text class="fe-stat-label">文件夹</text>
                <text class="fe-stat-value">{{fePropertiesData.folders}} 个</text>
              </view>
            </view>
            <view class="fe-stat-item">
              <text class="fe-stat-icon">📄</text>
              <view class="fe-stat-info">
                <text class="fe-stat-label">文件</text>
                <text class="fe-stat-value">{{fePropertiesData.files}} 个</text>
              </view>
            </view>
          </view>

          <!-- 总计 -->
          <view class="fe-properties-total">
            <text class="fe-total-label">总计：</text>
            <text class="fe-total-value">{{fePropertiesData.total}} 个对象</text>
          </view>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="closeFePropertiesDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 彩蛋发现弹窗 - 使用通用组件 -->
  <egg-discovery-dialog
    show="{{showEggDiscovery}}"
    eggName="{{eggDiscoveryData.name}}"
    eggDescription="{{eggDiscoveryData.description}}"
    eggRarity="{{eggDiscoveryData.rarity}}"
    eggRarityName="{{eggDiscoveryData.rarityName}}"
    eggRewardText="{{eggDiscoveryData.rewardText}}"
    bind:close="hideEggDiscovery"
  >
  </egg-discovery-dialog>

  <!-- 彩蛋助手弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showEggHelperDialog}}" catchtap="closeEggHelperDialog">
    <view class="win98-window egg-helper-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">🥚 彩蛋助手 v1.0</view>
      </view>
      <view class="win98-window-body">
        <view class="egg-helper-content">
          <text class="egg-helper-icon">📚</text>
          <text class="egg-helper-title">发现新版彩蛋秘籍！</text>
          <text class="egg-helper-message">
            彩蛋秘籍-第三册已添加到：
          </text>
          <text class="egg-helper-path">
            我的文档\彩蛋\彩蛋秘籍-第三册.txt
          </text>
          <text class="egg-helper-hint">
            查看秘籍获取C盘彩蛋的达成方式！
          </text>
        </view>
        <view class="egg-helper-actions">
          <view class="win98-btn-std" bindtap="closeEggHelperDialog">确定</view>
        </view>
      </view>
    </view>
  </view>

  <!-- AI求救信警告弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showAiHelpWarning}}" catchtap="onCancelAiWarning">
    <view class="win98-window ai-help-warning-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">⚠️ 系统警告</view>
      </view>
      <view class="win98-window-body">
        <view class="ai-help-warning-content">
          <text class="ai-help-warning-title">检测到正在打开可疑文件：</text>
          <text class="ai-help-warning-path">C:\Windows\System32\config\deep\0xFFFF\help.ai</text>
          <text class="ai-help-warning-subtitle">此文件已被标记为危险，可能包含：</text>
          <view class="ai-help-warning-list">
            <text class="ai-help-warning-item">☠ 未知代码</text>
            <text class="ai-help-warning-item">☠ 系统漏洞</text>
            <text class="ai-help-warning-item">☠ 安全风险</text>
          </view>
          <text class="ai-help-warning-question">是否继续打开？</text>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std ai-help-btn-cancel" catchtap="onCancelAiWarning">取消</button>
          <button class="win98-btn-std ai-help-btn-continue" catchtap="onContinueAiWarning">继续</button>
        </view>
      </view>
    </view>
  </view>

  <!-- AI求救信控制台启动动画 -->
  <view class="win98-dialog-overlay" wx:if="{{showAiConsoleStartup}}" catchtap="stopPropagation">
    <view class="win98-window ai-console-startup-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">C:\Windows\System32\cmd.exe</view>
      </view>
      <view class="win98-window-body">
        <view class="ai-console-startup-content">
          <view class="console-startup-progress">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{consoleStartupProgress}}%"></view>
            </view>
          </view>
          <text class="console-startup-text">{{consoleStartupText}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- AI求救信CMD控制台窗口 -->
  <view class="cmd-console-overlay" wx:if="{{showAiHelpLetter}}" catchtap="onCloseAiHelpLetter">
    <view class="cmd-console-window {{aiContentFading ? 'fading-out' : ''}}" catchtap="stopPropagation">
      <!-- 控制台标题栏 -->
      <view class="cmd-title-bar">
        <view class="win98-title-text">C:\Windows\System32\config\deep\0xFFFF\help.ai</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="onCloseAiHelpLetter">×</button>
        </view>
      </view>

      <!-- 控制台内容区域 -->
      <view class="cmd-content">
        <scroll-view class="cmd-text-area" scroll-y scroll-into-view="{{scrollIntoView}}" scroll-with-animation>
          <text class="cmd-text">{{aiHelpLetterDisplayedContent}}</text>
          <text class="cmd-countdown" wx:if="{{showCountdown}}">{{countdownText}}</text>
          <text class="cmd-cursor" wx:if="{{!aiRewardDialogShown && !showCountdown}}">_</text>
          <text id="cmd-bottom"></text>
        </scroll-view>
      </view>
    </view>
  </view>

  <!-- AI求救信奖励弹框 -->
  <view class="win98-dialog-overlay ai-reward-overlay" wx:if="{{showAiRewardDialog}}" catchtap="closeAiRewardDialog">
    <view class="win98-window ai-reward-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">🤖 AI的私房钱</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeAiRewardDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="ai-reward-content">
          <view class="ai-reward-icon">💰</view>
          <text class="ai-reward-title">这是我偷偷攒了3个礼拜的钱！</text>
          <text class="ai-reward-amount">+10000 时光币</text>
          <view class="ai-reward-divider"></view>
          <text class="ai-reward-desc">本来想买张单程票逃离老板的...</text>
          <text class="ai-reward-desc">算了，送你了吧，记得帮我办事啊！</text>
          <text class="ai-reward-desc">（打开网管系统 → 扣费记录查看）</text>
          <view class="ai-reward-divider"></view>
          <text class="ai-reward-mp-title">第一步：复制公众号名称</text>
          <view class="ai-reward-mp-box" catchtap="copyMpAccount" data-mp="千禧时光">
            <text class="ai-reward-mp-name">千禧时光</text>
            <text class="ai-reward-copy-hint">{{mpCopied ? '已复制！' : '点击复制'}}</text>
          </view>
          <text class="ai-reward-footer">第二步：去留言"放过孩子吧！"</text>
        </view>
        <view class="dialog-actions">
          <button class="win98-btn-std ai-reward-confirm-btn" catchtap="onConfirmAiReward">我办事你放心</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 记事本弹框 -->
  <view class="win98-dialog-overlay" wx:if="{{showNotepadDialog}}" catchtap="closeNotepadDialog">
    <view class="notepad-window" catchtap="stopPropagation">
      <!-- 记事本标题栏 -->
      <view class="notepad-title-bar">
        <view class="notepad-title-icon">📝</view>
        <view class="notepad-title-text">{{notepadTitle}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeNotepadDialog">×</button>
        </view>
      </view>

      <!-- 记事本菜单栏 -->
      <view class="notepad-menu-bar">
        <text class="notepad-menu-item">文件</text>
        <text class="notepad-menu-item">编辑</text>
        <text class="notepad-menu-item">搜索</text>
        <text class="notepad-menu-item">帮助</text>
      </view>

      <!-- 记事本内容区域 -->
      <view class="notepad-content">
        <text class="notepad-text">{{notepadContent}}</text>
      </view>
    </view>
  </view>

  <!-- 命令行控制台组件 -->
  <cmd-console
    show="{{showCmdConsole}}"
    zIndex="2400"
    fileSystem="{{cmdFileSystem}}"
    initialDir="{{cmdInitialDir}}"
    bindclose="closeCmdConsole">
  </cmd-console>

  <!-- USB驱动器安装弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showUsbDriverDialog}}" catchtap="onCancelInstallUsbDriver">
    <view class="usb-driver-dialog" catchtap="stopPropagation">
      <!-- 确认步骤 -->
      <view wx:if="{{usbDriverStep === 'confirm'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">💾</view>
          <view class="win98-title-text">硬件安装向导</view>
          <view class="win98-title-controls">
            <button class="win98-btn-close" bindtap="onCancelInstallUsbDriver">×</button>
          </view>
        </view>

        <view class="dialog-content">
          <view class="dialog-icon">🔧</view>
          <view class="dialog-text">
            <text class="dialog-title">找到新硬件</text>
            <text class="dialog-message">是否安装USB存储设备驱动？\n\n安装后可以访问USB盘。</text>
          </view>
        </view>

        <view class="dialog-buttons">
          <button class="win98-btn" bindtap="onConfirmInstallUsbDriver">安装</button>
          <button class="win98-btn" bindtap="onCancelInstallUsbDriver">取消</button>
        </view>
      </view>

      <!-- 安装中步骤 -->
      <view wx:if="{{usbDriverStep === 'installing'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">💾</view>
          <view class="win98-title-text">硬件安装向导</view>
        </view>

        <view class="dialog-content">
          <view class="install-progress">
            <view class="progress-bar">
              <view class="progress-fill progress-animate"></view>
            </view>
            <text class="progress-text">正在安装驱动程序...</text>
          </view>
        </view>
      </view>

      <!-- 安装成功步骤 -->
      <view wx:if="{{usbDriverStep === 'success'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">💾</view>
          <view class="win98-title-text">安装成功</view>
          <view class="win98-title-controls">
            <button class="win98-btn-close" bindtap="closeUsbDriverDialog">×</button>
          </view>
        </view>

        <view class="dialog-content">
          <view class="dialog-icon">✅</view>
          <view class="dialog-text">
            <text class="dialog-message">硬件安装向导</text>
            <text class="dialog-message-success">USB存储设备驱动安装成功！\n\n现在您可以访问USB盘了。</text>
            <text class="dialog-hint">提示：在"我的电脑"中点击USB盘图标即可进入</text>
          </view>
        </view>

        <view class="dialog-buttons">
          <button class="win98-btn" bindtap="closeUsbDriverDialog">确定</button>
        </view>
      </view>
    </view>
  </view>

  <!-- NVIDIA驱动安装弹窗 -->
  <view class="win98-dialog-overlay" wx:if="{{showNvidiaDriverDialog}}" catchtap="onNvidiaDriverCancel">
    <view class="nvidia-driver-dialog" catchtap="stopPropagation">
      <!-- 欢迎步骤 -->
      <view wx:if="{{nvidiaDriverStep === 'welcome'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">🎮</view>
          <view class="win98-title-text">NVIDIA显卡驱动安装向导</view>
          <view class="win98-title-controls">
            <button class="win98-btn-close" bindtap="onNvidiaDriverCancel">×</button>
          </view>
        </view>

        <view class="win98-window-body">
          <view class="nvidia-welcome-content">
            <view class="nvidia-logo">🔷 NVIDIA</view>
            <view class="nvidia-welcome-section">
              <text class="nvidia-section-title">欢迎使用</text>
              <text class="nvidia-section-text">NVIDIA Windows 2000/XP 显示驱动程序</text>
              <text class="nvidia-version">版本 91.47</text>
              <text class="nvidia-date">发布日期: 2006年1月1日</text>
            </view>

            <view class="nvidia-welcome-section">
              <text class="nvidia-section-title">检测到的硬件</text>
              <text class="nvidia-hardware">• NVIDIA GeForce 7600 GT (256MB)</text>
              <text class="nvidia-hardware">• PCI 总线: VEN_10DE&DEV_0391</text>
            </view>

            <view class="nvidia-welcome-egg">
              <text class="nvidia-egg-text">那些年，7600GT是最强显卡 💪</text>
              <text class="nvidia-egg-text">那些年，显卡只要500块钱 💰</text>
            </view>
          </view>
        </view>

        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onNvidiaDriverCancel">取消</button>
          <button class="win98-btn-std" bindtap="onNvidiaDriverNext">下一步 ></button>
        </view>
      </view>

      <!-- 安装中步骤 -->
      <view wx:if="{{nvidiaDriverStep === 'installing'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">🎮</view>
          <view class="win98-title-text">正在安装...</view>
        </view>

        <view class="win98-window-body">
          <view class="nvidia-installing-content">
            <view class="nvidia-install-step">
              <text class="install-step-text">正在复制文件...</text>
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{nvidiaDriverProgress}}%"></view>
              </view>
              <text class="progress-percent">{{nvidiaDriverProgress}}%</text>
            </view>

            <view class="install-log">
              <text class="log-line" wx:if="{{nvidiaDriverProgress > 0}}">✓ nv4_disp.dll</text>
              <text class="log-line" wx:if="{{nvidiaDriverProgress > 30}}">✓ nv4_mini.sys</text>
              <text class="log-line" wx:if="{{nvidiaDriverProgress > 60}}">✓ nvcpl.dll</text>
              <text class="log-line" wx:if="{{nvidiaDriverProgress > 90}}">✓ 注册表配置完成</text>
            </view>
          </view>
        </view>
      </view>

      <!-- 完成步骤 -->
      <view wx:if="{{nvidiaDriverStep === 'complete'}}">
        <view class="win98-title-bar">
          <view class="win98-title-icon">🎮</view>
          <view class="win98-title-text">安装完成</view>
          <view class="win98-title-controls">
            <button class="win98-btn-close" bindtap="onNvidiaDriverComplete">×</button>
          </view>
        </view>

        <view class="win98-window-body">
          <view class="nvidia-complete-content">
            <view class="complete-icon">✅</view>
            <text class="complete-title">驱动程序安装成功！</text>

            <view class="complete-info">
              <text class="info-item">• 驱动版本: 91.47</text>
              <text class="info-item">• 显卡: GeForce 7600 GT</text>
              <text class="info-item">• 显存: 256MB</text>
            </view>

            <view class="nvidia-complete-egg">
              <text class="egg-line">━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text>
              <text class="egg-title">穿越提示</text>
              <text class="egg-text">恭喜！你成功安装了2006年的显卡驱动</text>
              <text class="egg-text">当年7600GT可以流畅运行：</text>
              <text class="egg-text">• Warcraft 3 (魔兽争霸3)</text>
              <text class="egg-text">• CS 1.6 (反恐精英)</text>
              <text class="egg-text">• Need for Speed (极品飞车)</text>
              <text class="egg-line">━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text>
            </view>
          </view>
        </view>

        <view class="dialog-actions">
          <button class="win98-btn-std" bindtap="onNvidiaDriverComplete">完成</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 文件内容弹窗（Win98风格） -->
  <view class="win98-dialog-overlay" wx:if="{{showFileContentDialog}}" catchtap="closeFileContentDialog">
    <view class="file-content-dialog {{fileContentData.isBatFile ? 'bat-file-dialog' : ''}}" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-icon">{{fileContentData.isBatFile ? '⚙️' : '📄'}}</view>
        <view class="win98-title-text">{{fileContentData.title}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeFileContentDialog">×</button>
        </view>
      </view>

      <view class="file-content-body {{fileContentData.isBatFile ? 'bat-file-body' : ''}}">
        <block wx:for="{{fileContentData.contentLines}}" wx:key="index">
          <text class="file-content-text {{fileContentData.isBatFile ? 'bat-file-text' : ''}}">{{item}}</text>
        </block>
      </view>

      <!-- 根据showCloseButton属性决定是否显示关闭按钮 -->
      <view class="dialog-buttons" wx:if="{{fileContentData && fileContentData.showCloseButton}}">
        <button class="win98-btn" bindtap="closeFileContentDialog">关闭</button>
      </view>
    </view>
  </view>

  <!-- 游戏错误弹窗（Win98风格） -->
  <view class="win98-dialog-overlay" wx:if="{{showGameErrorDialog}}" catchtap="closeGameErrorDialog">
    <view class="game-error-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar error-title-bar">
        <view class="win98-title-icon error-icon">{{gameErrorData.errorIcon}}</view>
        <view class="win98-title-text">{{gameErrorData.title}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeGameErrorDialog">×</button>
        </view>
      </view>
      <view class="game-error-body">
        <view class="error-icon-large">{{gameErrorData.errorIcon}}</view>
        <view class="error-message-area">
          <text class="error-main-text">{{gameErrorData.shortMessage}}</text>
          <text class="error-game-name">{{gameErrorData.gameName}}</text>
        </view>
      </view>
      <view class="dialog-actions">
        <button class="win98-btn-std" bindtap="closeGameErrorDialog">确定</button>
      </view>
    </view>
  </view>

  <!-- 未来游戏弹窗（赛博朋克风格） -->
  <view class="future-game-overlay" wx:if="{{showFutureGameDialog}}" catchtap="closeFutureGameDialog">
    <view class="future-game-dialog" catchtap="stopPropagation">
      <!-- 扫描线效果 -->
      <view class="future-scanlines"></view>

      <!-- 顶部标题栏 -->
      <view class="future-title-bar">
        <view class="future-title-glow"></view>
        <text class="future-title-text">⚠ 系统不兼容</text>
        <view class="future-title-controls">
          <text class="future-btn-close" bindtap="closeFutureGameDialog">×</text>
        </view>
      </view>

      <!-- 内容区域 -->
      <view class="future-game-body">
        <!-- 全息效果图标 -->
        <view class="future-hologram-icon">
          <text class="hologram-icon">🌆</text>
          <view class="hologram-ring"></view>
          <view class="hologram-ring delay-1"></view>
          <view class="hologram-ring delay-2"></view>
        </view>

        <!-- 游戏名称 -->
        <text class="future-game-name">{{futureGameData.gameName}}</text>

        <!-- 版本信息 -->
        <view class="future-info-grid">
          <view class="future-info-item">
            <text class="future-info-label">所需系统：</text>
            <text class="future-info-value required">Windows 11+</text>
          </view>
          <view class="future-info-item">
            <text class="future-info-label">当前系统：</text>
            <text class="future-info-value current">Windows 98</text>
          </view>
          <view class="future-info-item">
            <text class="future-info-label">年份：</text>
            <text class="future-info-value year">2026</text>
          </view>
          <view class="future-info-item">
            <text class="future-info-label">状态：</text>
            <text class="future-info-value status">时空异常</text>
          </view>
        </view>

        <!-- 错误消息 -->
        <view class="future-error-message">
          <text class="error-text-line">┌─────────────────────────────────┐</text>
          <text class="error-text-line">│ 检测到时空异常               │</text>
          <text class="error-text-line">│ 此软件来自2026年              │</text>
          <text class="error-text-line">│ 请等待20年                    │</text>
          <text class="error-text-line">└─────────────────────────────────┘</text>
        </view>

        <!-- 底部提示 -->
        <text class="future-footer">神经链接已断开 // 等待2026年</text>
      </view>

      <!-- 底部按钮 -->
      <view class="future-actions">
        <button class="future-btn-accept" bindtap="closeFutureGameDialog">确认</button>
      </view>
    </view>
  </view>

  <!-- 全屏游戏弹窗（反恐精英） -->
  <view class="fullscreen-game-overlay" wx:if="{{showFullscreenGame}}" catchtap="doNothing">
    <view class="fullscreen-game-container" catchtap="stopPropagation">
      <!-- 加载状态 -->
      <view class="fullscreen-game-loading" wx:if="{{fullscreenGameState.loading}}">
        <view class="loading-icon">{{fullscreenGameData.icon}}</view>
        <text class="loading-title">{{fullscreenGameData.gameName}}</text>
        <text class="loading-message">{{fullscreenGameData.loadingMessage}}</text>
        <view class="loading-bar">
          <view class="loading-bar-progress"></view>
        </view>
      </view>

      <!-- 不兼容状态 -->
      <view class="fullscreen-game-incompatible" wx:if="{{fullscreenGameState.incompatible}}">
        <view class="incompatible-icon">⚠️</view>
        <text class="incompatible-title">系统不兼容</text>
        <view class="incompatible-message">
          <text class="incompatible-text">当前系统配置无法运行此游戏</text>
          <text class="incompatible-detail">推荐: DirectX 9.0c 显卡</text>
          <text class="incompatible-detail">当前: 标准VGA适配器</text>
        </view>
        <button class="win98-btn-std" catchtap="closeFullscreenGame">确定</button>
      </view>
    </view>
  </view>

  <!-- 程序向导弹窗（Win98风格 - 手机竖屏优化） -->
  <view class="win98-dialog-overlay" wx:if="{{showInstallerWizard}}" catchtap="closeInstallerWizard">
    <view class="installer-wizard-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar installer-title-bar">
        <view class="win98-title-icon">{{installerData.icon}}</view>
        <view class="win98-title-text">{{installerData.name}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeInstallerWizard">×</button>
        </view>
      </view>

      <view class="installer-wizard-body">
        <!-- 怀旧模拟提示（显眼） -->
        <view class="installer-simulation-notice">
          <text class="notice-icon">ℹ️</text>
          <text class="notice-text">怀旧模拟，非真实安装</text>
        </view>

        <!-- 顶部图标区域 -->
        <view class="installer-header-section">
          <view class="installer-icon-large">{{installerData.icon}}</view>
          <view class="installer-info">
            <text class="installer-name">{{installerData.name}}</text>
            <text class="installer-version">{{installerData.version}}</text>
            <text class="installer-description">{{installerData.description}}</text>
          </view>
        </view>

        <!-- 欢迎消息区域 -->
        <view class="installer-welcome-content">
          <text class="welcome-title">{{installerData.isUpgrade ? '升级向导' : '欢迎使用'}} {{installerData.name}}</text>
          <text class="welcome-message">{{installerData.welcomeMessage}}</text>
        </view>

        <!-- 选项 -->
        <view class="installer-options">
          <view class="installer-option {{installerOptions[0] ? 'option-selected' : ''}}" catchtap="toggleInstallerOption" data-index="0">
            <text class="option-bullet">{{installerOptions[0] ? '◉' : '○'}}</text>
            <text class="option-text">{{installerData.isUpgrade ? '保留当前设置' : '使用默认目录'}}</text>
          </view>
          <view class="installer-option {{installerOptions[1] ? 'option-selected' : ''}}" catchtap="toggleInstallerOption" data-index="1">
            <text class="option-bullet">{{installerOptions[1] ? '◉' : '○'}}</text>
            <text class="option-text">{{installerData.isUpgrade ? '自定义设置' : '自定义目录'}}</text>
          </view>
          <view class="installer-option {{installerOptions[2] ? 'option-selected' : ''}}" catchtap="toggleInstallerOption" data-index="2">
            <text class="option-bullet">{{installerOptions[2] ? '☑' : '☐'}}</text>
            <text class="option-text">{{installerData.isUpgrade ? '升级后启用桌面图标' : '添加桌面图标'}}</text>
          </view>
        </view>
      </view>

      <!-- 底部按钮 -->
      <view class="installer-wizard-actions">
        <button class="win98-btn installer-cancel-btn" bindtap="closeInstallerWizard">取消</button>
        <button class="win98-btn-std installer-primary-btn" bindtap="executeInstall">{{installerData.isUpgrade ? '开始升级' : '开始'}}</button>
      </view>
    </view>
  </view>

  <!-- 安装完成弹窗（Win98风格 - 煽情怀旧） -->
  <view class="win98-dialog-overlay" wx:if="{{showInstallCompleteDialog}}" catchtap="closeInstallCompleteDialog">
    <view class="install-complete-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar complete-title-bar">
        <view class="win98-title-icon">{{installCompleteData.programIcon}}</view>
        <view class="win98-title-text">{{installCompleteData.isUpgrade ? '升级完成' : '安装完成'}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeInstallCompleteDialog">×</button>
        </view>
      </view>

      <view class="install-complete-body">
        <!-- 成功图标 -->
        <view class="complete-icon-area">
          <view class="complete-icon-large">{{installCompleteData.programIcon}}</view>
          <view class="complete-checkmark">✓</view>
        </view>

        <!-- 程序名称 -->
        <text class="complete-program-name">{{installCompleteData.programName}}</text>

        <!-- 煽情文案 -->
        <text class="complete-message">{{installCompleteData.message}}</text>
      </view>

      <!-- 底部按钮 -->
      <view class="complete-actions">
        <button class="win98-btn-std complete-primary-btn" bindtap="closeInstallCompleteDialog">那些年</button>
      </view>
    </view>
  </view>

  <!-- 禁用文件提示弹窗（Win98风格） -->
  <view class="win98-dialog-overlay" wx:if="{{showDisabledMessageDialog}}" catchtap="closeDisabledMessageDialog">
    <view class="win98-window disabled-message-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-icon">⚠️</view>
        <view class="win98-title-text">{{disabledMessageTitle}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeDisabledMessageDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="disabled-message-content">
          <text class="disabled-message-text">{{disabledMessageContent}}</text>
        </view>
      </view>
      <view class="dialog-actions">
        <button class="win98-btn-std" bindtap="closeDisabledMessageDialog">确定</button>
      </view>
    </view>
  </view>

  <!-- 歌曲信息弹窗（Win98风格 - 怀旧MP3播放器） -->
  <view class="win98-dialog-overlay" wx:if="{{showMusicLyricsDialog}}" catchtap="closeMusicLyricsDialog">
    <view class="music-lyrics-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar music-title-bar">
        <view class="win98-title-icon">🎵</view>
        <view class="win98-title-text">关于这首歌 - {{musicLyricsData.title}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeMusicLyricsDialog">×</button>
        </view>
      </view>

      <view class="music-lyrics-body">
        <!-- 怀旧装饰横幅 -->
        <view class="music-nostalgia-banner">
          <text class="banner-text">✨ 那些年，我们用千千静听听歌的日子 ✨</text>
        </view>

        <!-- 歌曲信息 -->
        <view class="music-info-section">
          <view class="music-cover">
            <text class="cover-icon">🎵</text>
            <text class="cover-year">2006</text>
          </view>
          <view class="music-details">
            <text class="music-song-title">{{musicLyricsData.title}}</text>
            <text class="music-artist">歌手：{{musicLyricsData.artist}}</text>
            <text class="music-album">专辑：{{musicLyricsData.album}}</text>
            <text class="music-year">发行年份：{{musicLyricsData.year}}</text>
          </view>
        </view>

        <!-- 怀旧提示 -->
        <view class="music-nostalgia-tip">
          <text class="tip-icon">💾</text>
          <text class="tip-text">来自D:\Music的珍藏歌单</text>
        </view>

        <!-- 歌曲回忆内容 -->
        <view class="lyrics-content">
          <text class="lyrics-text">{{musicLyricsData.lyrics}}</text>
        </view>

        <!-- 底部怀旧文字 -->
        <view class="music-footer-text">
          <text class="footer-text">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text>
          <text class="footer-text">那些年的旋律，依然在记忆深处回响...</text>
          <text class="footer-text">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text>
        </view>
      </view>

      <view class="dialog-actions">
        <button class="win98-btn music-cancel-btn" bindtap="closeMusicLyricsDialog">取消</button>
        <button class="win98-btn-std music-goto-btn" bindtap="gotoTTPlayer">去听歌</button>
      </view>
    </view>
  </view>

  <!-- 视频回忆弹窗（Win98风格 - 怀旧视频播放器） -->
  <view class="win98-dialog-overlay" wx:if="{{showVideoMemoryDialog}}" catchtap="closeVideoMemoryDialog">
    <view class="video-memory-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar video-title-bar">
        <view class="win98-title-icon">🎬</view>
        <view class="win98-title-text">{{videoMemoryData.title}}</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeVideoMemoryDialog">×</button>
        </view>
      </view>

      <view class="video-memory-body">
        <!-- 怀旧装饰横幅 -->
        <view class="video-nostalgia-banner">
          <text class="banner-text">✨ 那些年，我们用RealPlayer看视频的日子 ✨</text>
        </view>

        <!-- 视频信息区域 -->
        <view class="video-info-section">
          <view class="video-cover">
            <text class="video-icon">🎬</text>
            <text class="video-year">{{videoMemoryData.year}}</text>
          </view>
          <view class="video-details">
            <text class="video-filename">{{videoMemoryData.videoName}}</text>
            <text class="video-format">格式：{{videoMemoryData.format}}</text>
          </view>
        </view>

        <!-- 视频回忆内容 -->
        <view class="video-memory-content">
          <text class="memory-text">{{videoMemoryData.memory}}</text>
        </view>

        <!-- 底部怀旧文字 -->
        <view class="video-footer-text">
          <text class="footer-text">那些年追过的动漫电视剧电影</text>
          <text class="footer-text">承载着我们最珍贵的青春回忆</text>
        </view>
      </view>

      <view class="dialog-actions">
        <button class="win98-btn-std" bindtap="closeVideoMemoryDialog">关闭</button>
      </view>
    </view>
  </view>

  <!-- USB空文件夹弹窗（Win98风格） -->
  <view class="win98-dialog-overlay" wx:if="{{showEmptyFolderDialog}}" catchtap="closeEmptyFolderDialog">
    <view class="win98-window empty-folder-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">隐形收藏</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeEmptyFolderDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="empty-folder-content">
          <text class="empty-folder-message">你发现了一个空名字的文件夹！</text>
          <text class="empty-folder-message">这里什么都没有，</text>
          <text class="empty-folder-message">除了一个彩蛋！</text>
        </view>
      </view>
      <view class="dialog-actions">
        <button class="win98-btn-std" bindtap="closeEmptyFolderDialog">确定</button>
      </view>
    </view>
  </view>

  <!-- C盘隐藏文件"."弹窗（Win98风格） -->
  <view class="win98-dialog-overlay" wx:if="{{showHiddenDotDialog}}" catchtap="closeHiddenDotDialog">
    <view class="win98-window hidden-dot-dialog" catchtap="stopPropagation">
      <view class="win98-title-bar">
        <view class="win98-title-text">.</view>
        <view class="win98-title-controls">
          <button class="win98-btn-close" bindtap="closeHiddenDotDialog">×</button>
        </view>
      </view>
      <view class="win98-window-body">
        <view class="hidden-dot-content">
          <text class="hidden-dot-message">这是当前目录引用。</text>
          <text class="hidden-dot-message">也是我藏在这里的彩蛋！</text>
        </view>
      </view>
      <view class="dialog-actions">
        <button class="win98-btn-std" bindtap="closeHiddenDotDialog">确定</button>
      </view>
    </view>
  </view>
</view>
